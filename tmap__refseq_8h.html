<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>TMAP: /Users/nilshomer/git/tmap/src/index/tmap_refseq.h File Reference</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />



</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">TMAP
   &#160;<span id="projectnumber">2.3.3</span>
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.5.1 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="dir_15187882eb12136f52a6e42c6006d23a.html">src</a>      </li>
      <li class="navelem"><a class="el" href="dir_24d216d6aaeec8eb45fed11932c4b1fb.html">index</a>      </li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Defines</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">tmap_refseq.h File Reference</div>  </div>
</div>
<div class="contents">
<div class="textblock"><code>#include &lt;stdint.h&gt;</code><br/>
<code>#include &quot;../util/tmap_string.h&quot;</code><br/>
<code>#include &quot;../util/tmap_definitions.h&quot;</code><br/>
<code>#include &quot;../io/tmap_file.h&quot;</code><br/>
</div>
<p><a href="tmap__refseq_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structtmap__anno__t.html">tmap_anno_t</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structtmap__refseq__t.html">tmap_refseq_t</a></td></tr>
<tr><td colspan="2"><h2><a name="define-members"></a>
Defines</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tmap__refseq_8h.html#a01d0d2d38ca0d14d521ed45028ca4068">TMAP_REFSEQ_BUFFER_SIZE</a>&#160;&#160;&#160;0x10000</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tmap__refseq_8h.html#a4001c80efab645cf3cebdbad4e260ea5">TMAP_REFSEQ_FASTA_LINE_LENGTH</a>&#160;&#160;&#160;72</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tmap__refseq_8h.html#a583d91a800a883a3a60008cfeb4b6c11">tmap_refseq_seq_memory</a>(_len)&#160;&#160;&#160;((size_t)((((_len)-1) &gt;&gt; 2) + 1))</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tmap__refseq_8h.html#a2b8adb7970378c47fc17edd50c302546">tmap_refseq_seq_byte_i</a>(_i)&#160;&#160;&#160;((_i) &gt;&gt; 2)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tmap__refseq_8h.html#a681a064c81c6fbcb95d2468b45a28254">tmap_refseq_seq_byte_shift</a>(_i)&#160;&#160;&#160;((0x3 - ((_i) &amp; 0x3)) &lt;&lt; 1)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tmap__refseq_8h.html#af8c8a5ca554b793d42e52f0f9b508baf">tmap_refseq_seq_store_i</a>(_refseq, _i, _c)&#160;&#160;&#160;(_refseq-&gt;seq[tmap_refseq_seq_byte_i(_i)] |= _c &lt;&lt; tmap_refseq_seq_byte_shift(_i))</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tmap__refseq_8h.html#aa11199f6755fe56d56faff77d3da563d">tmap_refseq_seq_i</a>(_refseq, _i)&#160;&#160;&#160;((_refseq-&gt;seq[tmap_refseq_seq_byte_i(_i)] &gt;&gt; tmap_refseq_seq_byte_shift(_i)) &amp; 0x3)</td></tr>
<tr><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tmap__refseq_8h.html#aff1e4a049f1b1e36851b54e439de8f24">tmap_refseq_get_version_format</a> (const char *v)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">uint64_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tmap__refseq_8h.html#a4191c06cc389a4d5df316841ca21c5c0">tmap_refseq_fasta2pac</a> (const char *fn_fasta, int32_t compression, int32_t fwd_only)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tmap__refseq_8h.html#ac8a8177a32db12857e6e7fc585fb5862">tmap_refseq_pac2revpac</a> (const char *fn_fasta)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tmap__refseq_8h.html#a5f9084f4e2283442e38b6be674fa584a">tmap_refseq_write</a> (<a class="el" href="structtmap__refseq__t.html">tmap_refseq_t</a> *refseq, const char *fn_fasta)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="structtmap__refseq__t.html">tmap_refseq_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tmap__refseq_8h.html#afff8758b98735cb3c039c812426ac478">tmap_refseq_read</a> (const char *fn_fasta)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tmap__refseq_8h.html#ae4019c2d92c806268d67bf8ed9663a5d">tmap_refseq_approx_num_bytes</a> (uint64_t len)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tmap__refseq_8h.html#a0b13f8bf8e2fbf7c6af035267ab06b72">tmap_refseq_shm_num_bytes</a> (<a class="el" href="structtmap__refseq__t.html">tmap_refseq_t</a> *refseq)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tmap__refseq_8h.html#a665c34314ed9eae4f0046b7dcd90afd9">tmap_refseq_shm_read_num_bytes</a> (const char *fn_fasta)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">uint8_t *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tmap__refseq_8h.html#aad1d1500ab81236559d851c70f550c43">tmap_refseq_shm_pack</a> (<a class="el" href="structtmap__refseq__t.html">tmap_refseq_t</a> *refseq, uint8_t *buf)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="structtmap__refseq__t.html">tmap_refseq_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tmap__refseq_8h.html#acfc453034765c4d036bffb351cbbf715">tmap_refseq_shm_unpack</a> (uint8_t *buf)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tmap__refseq_8h.html#a97e021d0aaedb9349383d85b1275cfcf">tmap_refseq_destroy</a> (<a class="el" href="structtmap__refseq__t.html">tmap_refseq_t</a> *refseq)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="tmap__definitions_8h.html#a6cc3d565d74ac87fb1b55c97a888421b">tmap_bwt_int_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tmap__refseq_8h.html#a6c044120bf89b72fab20e5f40bde3171">tmap_refseq_pac2real</a> (const <a class="el" href="structtmap__refseq__t.html">tmap_refseq_t</a> *refseq, <a class="el" href="tmap__definitions_8h.html#a6cc3d565d74ac87fb1b55c97a888421b">tmap_bwt_int_t</a> pacpos, uint32_t aln_length, uint32_t *seqid, uint32_t *pos, uint8_t *strand)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tmap__refseq_8h.html#ad10045f743f7c12be483edbfe25eb120">tmap_refseq_subseq</a> (const <a class="el" href="structtmap__refseq__t.html">tmap_refseq_t</a> *refseq, <a class="el" href="tmap__definitions_8h.html#a6cc3d565d74ac87fb1b55c97a888421b">tmap_bwt_int_t</a> pacpos, uint32_t length, uint8_t *target)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">uint8_t *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tmap__refseq_8h.html#adde14700a91ca8fe34b08cab3cecfc3e">tmap_refseq_subseq2</a> (const <a class="el" href="structtmap__refseq__t.html">tmap_refseq_t</a> *refseq, uint32_t seqid, uint32_t start, uint32_t end, uint8_t *target, int32_t to_n, int32_t *conv)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tmap__refseq_8h.html#ac66c32ebce8670cf6876839e6c0b358a">tmap_refseq_amb_bases</a> (const <a class="el" href="structtmap__refseq__t.html">tmap_refseq_t</a> *refseq, uint32_t seqid, uint32_t start, uint32_t end)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tmap__refseq_8h.html#a1f718fc01ffc9273a4891e52bd5ad76a">tmap_refseq_fasta2pac_main</a> (int argc, char *argv[])</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tmap__refseq_8h.html#a30f6c28f78469bbd98accfd50e5b2ba8">tmap_refseq_refinfo_main</a> (int argc, char *argv[])</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tmap__refseq_8h.html#af31f33f40c516a60bd220438fdd449ea">tmap_refseq_pac2fasta_main</a> (int argc, char *argv[])</td></tr>
</table>
<hr/><h2>Define Documentation</h2>
<a class="anchor" id="a01d0d2d38ca0d14d521ed45028ca4068"></a><!-- doxytag: member="tmap_refseq.h::TMAP_REFSEQ_BUFFER_SIZE" ref="a01d0d2d38ca0d14d521ed45028ca4068" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define TMAP_REFSEQ_BUFFER_SIZE&#160;&#160;&#160;0x10000</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>DNA Reference Sequence Library </p>

</div>
</div>
<a class="anchor" id="a4001c80efab645cf3cebdbad4e260ea5"></a><!-- doxytag: member="tmap_refseq.h::TMAP_REFSEQ_FASTA_LINE_LENGTH" ref="a4001c80efab645cf3cebdbad4e260ea5" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define TMAP_REFSEQ_FASTA_LINE_LENGTH&#160;&#160;&#160;72</td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a2b8adb7970378c47fc17edd50c302546"></a><!-- doxytag: member="tmap_refseq.h::tmap_refseq_seq_byte_i" ref="a2b8adb7970378c47fc17edd50c302546" args="(_i)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define tmap_refseq_seq_byte_i</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">_i</td><td>)</td>
          <td>&#160;&#160;&#160;((_i) &gt;&gt; 2)</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">_i</td><td>the 0-based base position </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>the 0-based byte index </dd></dl>

</div>
</div>
<a class="anchor" id="a681a064c81c6fbcb95d2468b45a28254"></a><!-- doxytag: member="tmap_refseq.h::tmap_refseq_seq_byte_shift" ref="a681a064c81c6fbcb95d2468b45a28254" args="(_i)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define tmap_refseq_seq_byte_shift</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">_i</td><td>)</td>
          <td>&#160;&#160;&#160;((0x3 - ((_i) &amp; 0x3)) &lt;&lt; 1)</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">_i</td><td>the 0-based base position </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>the number of bits the base is shifted (returns a multiple of two)</dd></dl>
<p>the reference is stored in a 2-bit format </p>

</div>
</div>
<a class="anchor" id="aa11199f6755fe56d56faff77d3da563d"></a><!-- doxytag: member="tmap_refseq.h::tmap_refseq_seq_i" ref="aa11199f6755fe56d56faff77d3da563d" args="(_refseq, _i)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define tmap_refseq_seq_i</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">_refseq, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">_i&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;((_refseq-&gt;seq[tmap_refseq_seq_byte_i(_i)] &gt;&gt; tmap_refseq_seq_byte_shift(_i)) &amp; 0x3)</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">_refseq</td><td>pointer to the structure holding the reference sequence </td></tr>
    <tr><td class="paramname">_i</td><td>the 0-based base position to retrieve </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>the base's 2-bit integer representation </dd></dl>

</div>
</div>
<a class="anchor" id="a583d91a800a883a3a60008cfeb4b6c11"></a><!-- doxytag: member="tmap_refseq.h::tmap_refseq_seq_memory" ref="a583d91a800a883a3a60008cfeb4b6c11" args="(_len)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define tmap_refseq_seq_memory</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">_len</td><td>)</td>
          <td>&#160;&#160;&#160;((size_t)((((_len)-1) &gt;&gt; 2) + 1))</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">_len</td><td>the number of bases stored </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>the number of bytes allocated </dd></dl>

</div>
</div>
<a class="anchor" id="af8c8a5ca554b793d42e52f0f9b508baf"></a><!-- doxytag: member="tmap_refseq.h::tmap_refseq_seq_store_i" ref="af8c8a5ca554b793d42e52f0f9b508baf" args="(_refseq, _i, _c)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define tmap_refseq_seq_store_i</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">_refseq, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">_i, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">_c&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;(_refseq-&gt;seq[tmap_refseq_seq_byte_i(_i)] |= _c &lt;&lt; tmap_refseq_seq_byte_shift(_i))</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">_refseq</td><td>pointer to the structure holding the reference sequence </td></tr>
    <tr><td class="paramname">_i</td><td>the 0-based base position to store </td></tr>
    <tr><td class="paramname">_c</td><td>the base's 2-bit integer representation </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="ac66c32ebce8670cf6876839e6c0b358a"></a><!-- doxytag: member="tmap_refseq.h::tmap_refseq_amb_bases" ref="ac66c32ebce8670cf6876839e6c0b358a" args="(const tmap_refseq_t *refseq, uint32_t seqid, uint32_t start, uint32_t end)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int32_t tmap_refseq_amb_bases </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structtmap__refseq__t.html">tmap_refseq_t</a> *&#160;</td>
          <td class="paramname"><em>refseq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>seqid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>start</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>end</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Checks if the given reference range has ambiguous bases </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">refseq</td><td>pointer to the structure in which the data is stored </td></tr>
    <tr><td class="paramname">seqid</td><td>the sequence index (one-based) </td></tr>
    <tr><td class="paramname">start</td><td>the start position (one-based and inclusive) </td></tr>
    <tr><td class="paramname">end</td><td>the end position (one-based and inclusive) </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>zero if none were found, otherwise the one-based index into "amb_bases" array </dd></dl>

</div>
</div>
<a class="anchor" id="ae4019c2d92c806268d67bf8ed9663a5d"></a><!-- doxytag: member="tmap_refseq.h::tmap_refseq_approx_num_bytes" ref="ae4019c2d92c806268d67bf8ed9663a5d" args="(uint64_t len)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t tmap_refseq_approx_num_bytes </td>
          <td>(</td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname"><em>len</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">len</td><td>the refseq length </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>the approximate number of bytes required for this refseq in shared memory </dd></dl>

</div>
</div>
<a class="anchor" id="a97e021d0aaedb9349383d85b1275cfcf"></a><!-- doxytag: member="tmap_refseq.h::tmap_refseq_destroy" ref="a97e021d0aaedb9349383d85b1275cfcf" args="(tmap_refseq_t *refseq)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void tmap_refseq_destroy </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structtmap__refseq__t.html">tmap_refseq_t</a> *&#160;</td>
          <td class="paramname"><em>refseq</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">refseq</td><td>pointer to the structure in which the data is stored </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a4191c06cc389a4d5df316841ca21c5c0"></a><!-- doxytag: member="tmap_refseq.h::tmap_refseq_fasta2pac" ref="a4191c06cc389a4d5df316841ca21c5c0" args="(const char *fn_fasta, int32_t compression, int32_t fwd_only)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint64_t tmap_refseq_fasta2pac </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>fn_fasta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>compression</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>fwd_only</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">fn_fasta</td><td>the file name of the fasta file </td></tr>
    <tr><td class="paramname">compression</td><td>the type of compression, if any to be used </td></tr>
    <tr><td class="paramname">fwd_only</td><td>1 if to pack the forward sequence only, 0 otherwise </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>the length of the reference sequence </dd></dl>

</div>
</div>
<a class="anchor" id="a1f718fc01ffc9273a4891e52bd5ad76a"></a><!-- doxytag: member="tmap_refseq.h::tmap_refseq_fasta2pac_main" ref="a1f718fc01ffc9273a4891e52bd5ad76a" args="(int argc, char *argv[])" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int tmap_refseq_fasta2pac_main </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>argc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>argv</em>[]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>main-like function for 'tmap fasta2pac' </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">argc</td><td>the number of arguments </td></tr>
    <tr><td class="paramname">argv</td><td>the argument list </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>0 if executed successful </dd></dl>

</div>
</div>
<a class="anchor" id="aff1e4a049f1b1e36851b54e439de8f24"></a><!-- doxytag: member="tmap_refseq.h::tmap_refseq_get_version_format" ref="aff1e4a049f1b1e36851b54e439de8f24" args="(const char *v)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* tmap_refseq_get_version_format </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>v</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>returns the index version format given a package version </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">v</td><td>the package version string </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>the index version format string </dd></dl>

</div>
</div>
<a class="anchor" id="af31f33f40c516a60bd220438fdd449ea"></a><!-- doxytag: member="tmap_refseq.h::tmap_refseq_pac2fasta_main" ref="af31f33f40c516a60bd220438fdd449ea" args="(int argc, char *argv[])" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int tmap_refseq_pac2fasta_main </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>argc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>argv</em>[]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>main-like function for 'tmap pac2fasta' </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">argc</td><td>the number of arguments </td></tr>
    <tr><td class="paramname">argv</td><td>the argument list </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>0 if executed successful </dd></dl>

</div>
</div>
<a class="anchor" id="a6c044120bf89b72fab20e5f40bde3171"></a><!-- doxytag: member="tmap_refseq.h::tmap_refseq_pac2real" ref="a6c044120bf89b72fab20e5f40bde3171" args="(const tmap_refseq_t *refseq, tmap_bwt_int_t pacpos, uint32_t aln_length, uint32_t *seqid, uint32_t *pos, uint8_t *strand)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="tmap__definitions_8h.html#a6cc3d565d74ac87fb1b55c97a888421b">tmap_bwt_int_t</a> tmap_refseq_pac2real </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structtmap__refseq__t.html">tmap_refseq_t</a> *&#160;</td>
          <td class="paramname"><em>refseq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="tmap__definitions_8h.html#a6cc3d565d74ac87fb1b55c97a888421b">tmap_bwt_int_t</a>&#160;</td>
          <td class="paramname"><em>pacpos</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>aln_length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t *&#160;</td>
          <td class="paramname"><em>seqid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t *&#160;</td>
          <td class="paramname"><em>pos</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>strand</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">refseq</td><td>pointer to the structure in which the data is stored </td></tr>
    <tr><td class="paramname">pacpos</td><td>the packed FASTA position (one-based) </td></tr>
    <tr><td class="paramname">aln_length</td><td>the alignment length </td></tr>
    <tr><td class="paramname">seqid</td><td>the zero-based sequence index to be returned </td></tr>
    <tr><td class="paramname">pos</td><td>the one-based position to be returned </td></tr>
    <tr><td class="paramname">strand</td><td>the strand (0 - forward, 1 - reverse) </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>the one-based position, 0 if not found (i.e. overlaps two chromosomes) </dd></dl>

</div>
</div>
<a class="anchor" id="ac8a8177a32db12857e6e7fc585fb5862"></a><!-- doxytag: member="tmap_refseq.h::tmap_refseq_pac2revpac" ref="ac8a8177a32db12857e6e7fc585fb5862" args="(const char *fn_fasta)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void tmap_refseq_pac2revpac </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>fn_fasta</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">fn_fasta</td><td>the file name of the fasta file </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="afff8758b98735cb3c039c812426ac478"></a><!-- doxytag: member="tmap_refseq.h::tmap_refseq_read" ref="afff8758b98735cb3c039c812426ac478" args="(const char *fn_fasta)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structtmap__refseq__t.html">tmap_refseq_t</a>* tmap_refseq_read </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>fn_fasta</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">fn_fasta</td><td>the fn_fasta of the file to be read, usually the fasta file name </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>a pointer to the initialized memory </dd></dl>

</div>
</div>
<a class="anchor" id="a30f6c28f78469bbd98accfd50e5b2ba8"></a><!-- doxytag: member="tmap_refseq.h::tmap_refseq_refinfo_main" ref="a30f6c28f78469bbd98accfd50e5b2ba8" args="(int argc, char *argv[])" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int tmap_refseq_refinfo_main </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>argc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>argv</em>[]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>main-like function for 'tmap refinfo' </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">argc</td><td>the number of arguments </td></tr>
    <tr><td class="paramname">argv</td><td>the argument list </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>0 if executed successful </dd></dl>

</div>
</div>
<a class="anchor" id="a0b13f8bf8e2fbf7c6af035267ab06b72"></a><!-- doxytag: member="tmap_refseq.h::tmap_refseq_shm_num_bytes" ref="a0b13f8bf8e2fbf7c6af035267ab06b72" args="(tmap_refseq_t *refseq)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t tmap_refseq_shm_num_bytes </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structtmap__refseq__t.html">tmap_refseq_t</a> *&#160;</td>
          <td class="paramname"><em>refseq</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">refseq</td><td>the refseq structure </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>the number of bytes required for this refseq in shared memory </dd></dl>

</div>
</div>
<a class="anchor" id="aad1d1500ab81236559d851c70f550c43"></a><!-- doxytag: member="tmap_refseq.h::tmap_refseq_shm_pack" ref="aad1d1500ab81236559d851c70f550c43" args="(tmap_refseq_t *refseq, uint8_t *buf)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t* tmap_refseq_shm_pack </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structtmap__refseq__t.html">tmap_refseq_t</a> *&#160;</td>
          <td class="paramname"><em>refseq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>buf</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">refseq</td><td>the refseq structure to pack </td></tr>
    <tr><td class="paramname">buf</td><td>the byte array in which to pack the refseq data </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>a pointer to the next unused byte in memory </dd></dl>

</div>
</div>
<a class="anchor" id="a665c34314ed9eae4f0046b7dcd90afd9"></a><!-- doxytag: member="tmap_refseq.h::tmap_refseq_shm_read_num_bytes" ref="a665c34314ed9eae4f0046b7dcd90afd9" args="(const char *fn_fasta)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t tmap_refseq_shm_read_num_bytes </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>fn_fasta</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">fn_fasta</td><td>the fn_fasta of the file to be read, usually the fasta file name </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>the number of bytes required for this refseq in shared memory </dd></dl>

</div>
</div>
<a class="anchor" id="acfc453034765c4d036bffb351cbbf715"></a><!-- doxytag: member="tmap_refseq.h::tmap_refseq_shm_unpack" ref="acfc453034765c4d036bffb351cbbf715" args="(uint8_t *buf)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structtmap__refseq__t.html">tmap_refseq_t</a>* tmap_refseq_shm_unpack </td>
          <td>(</td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>buf</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">buf</td><td>the byte array in which to unpack the refseq data </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>a pointer to the initialized refseq structure </dd></dl>

</div>
</div>
<a class="anchor" id="ad10045f743f7c12be483edbfe25eb120"></a><!-- doxytag: member="tmap_refseq.h::tmap_refseq_subseq" ref="ad10045f743f7c12be483edbfe25eb120" args="(const tmap_refseq_t *refseq, tmap_bwt_int_t pacpos, uint32_t length, uint8_t *target)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int32_t tmap_refseq_subseq </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structtmap__refseq__t.html">tmap_refseq_t</a> *&#160;</td>
          <td class="paramname"><em>refseq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="tmap__definitions_8h.html#a6cc3d565d74ac87fb1b55c97a888421b">tmap_bwt_int_t</a>&#160;</td>
          <td class="paramname"><em>pacpos</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>target</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Retrieves a subsequence of the reference in 2-bit format </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">refseq</td><td>pointer to the structure in which the data is stored </td></tr>
    <tr><td class="paramname">pacpos</td><td>the packed FASTA position (one-based) </td></tr>
    <tr><td class="paramname">length</td><td>the subsequence length retrieve </td></tr>
    <tr><td class="paramname">target</td><td>the target in which to store the data (must be allocated with enough memory) </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>the length retrieved </dd></dl>

</div>
</div>
<a class="anchor" id="adde14700a91ca8fe34b08cab3cecfc3e"></a><!-- doxytag: member="tmap_refseq.h::tmap_refseq_subseq2" ref="adde14700a91ca8fe34b08cab3cecfc3e" args="(const tmap_refseq_t *refseq, uint32_t seqid, uint32_t start, uint32_t end, uint8_t *target, int32_t to_n, int32_t *conv)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t* tmap_refseq_subseq2 </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structtmap__refseq__t.html">tmap_refseq_t</a> *&#160;</td>
          <td class="paramname"><em>refseq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>seqid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>start</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>end</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>target</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>to_n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t *&#160;</td>
          <td class="paramname"><em>conv</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Retrieves a subsequence of the reference in 2-bit format </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">refseq</td><td>pointer to the structure in which the data is stored </td></tr>
    <tr><td class="paramname">seqid</td><td>the sequence id (one-based) </td></tr>
    <tr><td class="paramname">start</td><td>the start position (one-based) </td></tr>
    <tr><td class="paramname">end</td><td>the end position (one-based) </td></tr>
    <tr><td class="paramname">target</td><td>pre-allocated memory for the target </td></tr>
    <tr><td class="paramname">to_n</td><td>change all ambiguous bases to N, otherwise they will be returned as the correct code </td></tr>
    <tr><td class="paramname">conv</td><td>the number of bases converted to ambiguity bases </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>the target sequence if successful, NULL otherwise </dd></dl>

</div>
</div>
<a class="anchor" id="a5f9084f4e2283442e38b6be674fa584a"></a><!-- doxytag: member="tmap_refseq.h::tmap_refseq_write" ref="a5f9084f4e2283442e38b6be674fa584a" args="(tmap_refseq_t *refseq, const char *fn_fasta)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void tmap_refseq_write </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structtmap__refseq__t.html">tmap_refseq_t</a> *&#160;</td>
          <td class="paramname"><em>refseq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>fn_fasta</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">refseq</td><td>pointer to the structure in which to store the data </td></tr>
    <tr><td class="paramname">fn_fasta</td><td>the fn_fasta of the file to be written, usually the fasta file name </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div>


<hr class="footer"/><address class="footer"><small>
Generated on Wed Jun 13 2012 15:53:30 for TMAP by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.7.5.1
</small></address>

</body>
</html>
