<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>TMAP: /Users/nilshomer/git/tmap/src/sw/lib/vsw.h Source File</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />



</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">TMAP
   &#160;<span id="projectnumber">0.0.1</span>
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.5.1 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="dir_15187882eb12136f52a6e42c6006d23a.html">src</a>      </li>
      <li class="navelem"><a class="el" href="dir_23fff77d740776b7010fa4aa338611a4.html">sw</a>      </li>
      <li class="navelem"><a class="el" href="dir_5fb6cca06e043ecc771cf1d18073b8ad.html">lib</a>      </li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="headertitle">
<div class="title">vsw.h</div>  </div>
</div>
<div class="contents">
<a href="vsw_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/* Copyright (C) 2010 Ion Torrent Systems, Inc. All Rights Reserved */</span>
<a name="l00002"></a>00002 <span class="comment">/* The MIT License</span>
<a name="l00003"></a>00003 <span class="comment"></span>
<a name="l00004"></a>00004 <span class="comment">   Copyright (c) 2011 by Attractive Chaos &lt;attractor@live.co.uk&gt;</span>
<a name="l00005"></a>00005 <span class="comment"></span>
<a name="l00006"></a>00006 <span class="comment">   Permission is hereby granted, free of charge, to any person obtaining</span>
<a name="l00007"></a>00007 <span class="comment">   a copy of this software and associated documentation files (the</span>
<a name="l00008"></a>00008 <span class="comment">   &quot;Software&quot;), to deal in the Software without restriction, including</span>
<a name="l00009"></a>00009 <span class="comment">   without limitation the rights to use, copy, modify, merge, publish,</span>
<a name="l00010"></a>00010 <span class="comment">   distribute, sublicense, and/or sell copies of the Software, and to</span>
<a name="l00011"></a>00011 <span class="comment">   permit persons to whom the Software is furnished to do so, subject to</span>
<a name="l00012"></a>00012 <span class="comment">   the following conditions:</span>
<a name="l00013"></a>00013 <span class="comment"></span>
<a name="l00014"></a>00014 <span class="comment">   The above copyright notice and this permission notice shall be</span>
<a name="l00015"></a>00015 <span class="comment">   included in all copies or substantial portions of the Software.</span>
<a name="l00016"></a>00016 <span class="comment"></span>
<a name="l00017"></a>00017 <span class="comment">   THE SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND,</span>
<a name="l00018"></a>00018 <span class="comment">   EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF</span>
<a name="l00019"></a>00019 <span class="comment">   MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND</span>
<a name="l00020"></a>00020 <span class="comment">   NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS</span>
<a name="l00021"></a>00021 <span class="comment">   BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN</span>
<a name="l00022"></a>00022 <span class="comment">   ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN</span>
<a name="l00023"></a>00023 <span class="comment">   CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE</span>
<a name="l00024"></a>00024 <span class="comment">   SOFTWARE.</span>
<a name="l00025"></a>00025 <span class="comment">   */</span>
<a name="l00026"></a>00026 
<a name="l00027"></a>00027 <span class="preprocessor">#ifndef VSW_H</span>
<a name="l00028"></a>00028 <span class="preprocessor"></span><span class="preprocessor">#define VSW_H</span>
<a name="l00029"></a>00029 <span class="preprocessor"></span>
<a name="l00030"></a>00030 <span class="comment">// TODO: document</span>
<a name="l00031"></a>00031 
<a name="l00032"></a>00032 <span class="preprocessor">#include &lt;stdlib.h&gt;</span>
<a name="l00033"></a>00033 <span class="preprocessor">#include &lt;stdint.h&gt;</span>
<a name="l00034"></a>00034 <span class="preprocessor">#include &lt;emmintrin.h&gt;</span>
<a name="l00035"></a>00035 <span class="preprocessor">#include &lt;unistd.h&gt;</span>
<a name="l00036"></a>00036 
<a name="l00037"></a>00037 <span class="comment">//#define VSW_DEBUG 1</span>
<a name="l00038"></a>00038 
<a name="l00039"></a>00039 <span class="comment">// Gives the # of bytes to align the memory in 16-byte increments</span>
<a name="l00040"></a><a class="code" href="vsw_8h.html#a9977533870139475d78397272d150402">00040</a> <span class="preprocessor">#define __vsw_16(_val) (((_val) + 15) &gt;&gt; 4 &lt;&lt; 4)</span>
<a name="l00041"></a>00041 <span class="preprocessor"></span>
<a name="l00043"></a><a class="code" href="vsw_8h.html#a97b136be97155232f6853593b0fbf066">00043</a> <span class="preprocessor">#define __vsw_mm_store_si128(_dest, _val) _mm_store_si128(_dest, _val)</span>
<a name="l00044"></a><a class="code" href="vsw_8h.html#a71e9392fe66dec8e7cb4a2bf12284572">00044</a> <span class="preprocessor"></span><span class="preprocessor">#define __vsw_mm_load_si128(_src) _mm_load_si128(_src)</span>
<a name="l00045"></a><a class="code" href="vsw_8h.html#ab39d0694de84517ac76e17c39b3573a8">00045</a> <span class="preprocessor"></span><span class="preprocessor">#define __vsw_mm_slli_si128(_src, _imm) _mm_slli_si128(_src, _imm)</span>
<a name="l00046"></a><a class="code" href="vsw_8h.html#a0c26efc61e48222874d1fb2984c18218">00046</a> <span class="preprocessor"></span><span class="preprocessor">#define __vsw_mm_srli_si128(_src, _imm) _mm_srli_si128(_src, _imm)</span>
<a name="l00047"></a>00047 <span class="preprocessor"></span>
<a name="l00049"></a><a class="code" href="vsw_8h.html#a117d40ae0487406fcd7855030d7cd65e">00049</a> <span class="preprocessor">#define __vsw16_mm_store_si128(_dest, _val) _mm_store_si128(_dest, _val)</span>
<a name="l00050"></a><a class="code" href="vsw_8h.html#a05a6af5903e60af921c638bf149f194a">00050</a> <span class="preprocessor"></span><span class="preprocessor">#define __vsw16_mm_load_si128(_src) _mm_load_si128(_src)</span>
<a name="l00051"></a><a class="code" href="vsw_8h.html#a578279aee7d769298a3d8e9e71143885">00051</a> <span class="preprocessor"></span><span class="preprocessor">#define __vsw16_mm_slli_si128(_src, _imm) _mm_slli_si128(_src, _imm)</span>
<a name="l00052"></a><a class="code" href="vsw_8h.html#af6882f37f7a686f10fc29ba6d29347cc">00052</a> <span class="preprocessor"></span><span class="preprocessor">#define __vsw16_mm_srli_si128(_src, _imm) _mm_srli_si128(_src, _imm)</span>
<a name="l00053"></a><a class="code" href="vsw_8h.html#a17e79788f3a0964096f07cd8bacbd690">00053</a> <span class="preprocessor"></span><span class="preprocessor">#define __vsw16_mm_set1_epi16(_val) _mm_set1_epi16(_val)</span>
<a name="l00054"></a><a class="code" href="vsw_8h.html#ad5dad2125bf81053475d9d82b9d2538c">00054</a> <span class="preprocessor"></span><span class="preprocessor">#define __vsw16_mm_set_epi16(_r0, _r1, _r2, _r3, _r4, _r5, _r6, _r7) _mm_set_epi16(_r7, _r6, _r5, _r4, _r3, _r2, _r1, _r0)</span>
<a name="l00055"></a><a class="code" href="vsw_8h.html#ad9013183846d4008e7793a3dd25ec05c">00055</a> <span class="preprocessor"></span><span class="preprocessor">#define __vsw16_mm_adds_epi16(_a, _b) _mm_adds_epi16(_a, _b)</span>
<a name="l00056"></a><a class="code" href="vsw_8h.html#ac50a243401fe50d88a8c4776a86a3010">00056</a> <span class="preprocessor"></span><span class="preprocessor">#define __vsw16_mm_subs_epi16(_a, _b) _mm_subs_epi16(_a, _b)</span>
<a name="l00057"></a><a class="code" href="vsw_8h.html#af4e06c0c71cb3fb93ae9f6a58731407d">00057</a> <span class="preprocessor"></span><span class="preprocessor">#define __vsw16_mm_max_epi16(_a, _b) _mm_max_epi16(_a, _b)</span>
<a name="l00058"></a><a class="code" href="vsw_8h.html#a26b62a59e14754d73b6c2959da4035ab">00058</a> <span class="preprocessor"></span><span class="preprocessor">#define __vsw16_mm_min_epi16(_a, _b) _mm_min_epi16(_a, _b)</span>
<a name="l00059"></a><a class="code" href="vsw_8h.html#a242b74a897eec925ec1017894176766d">00059</a> <span class="preprocessor"></span><span class="preprocessor">#define __vsw16_mm_movemask_epi16(_a) _mm_movemask_epi8(_a) // NB: this should be 8-bit...</span>
<a name="l00060"></a><a class="code" href="vsw_8h.html#ae800f55e0bd67ac6d3437eb2d3459dad">00060</a> <span class="preprocessor"></span><span class="preprocessor">#define __vsw16_mm_cmpeq_epi16(_a, _b) _mm_cmpeq_epi16(_a, _b)</span>
<a name="l00061"></a><a class="code" href="vsw_8h.html#aebb0031d681092160087fb3f0756ab22">00061</a> <span class="preprocessor"></span><span class="preprocessor">#define __vsw16_mm_cmplt_epi16(_a, _b) _mm_cmplt_epi16(_a, _b)</span>
<a name="l00062"></a><a class="code" href="vsw_8h.html#ace7ec75f593adf4fcd612bafd08f1d8b">00062</a> <span class="preprocessor"></span><span class="preprocessor">#define __vsw16_mm_cmpgt_epi16(_a, _b) _mm_cmpgt_epi16(_a, _b)</span>
<a name="l00063"></a><a class="code" href="vsw_8h.html#ace2c6a6dfe053a9962f8015b05269660">00063</a> <span class="preprocessor"></span><span class="preprocessor">#define __vsw16_mm_insert_epi16(_a, _b, _imm) _mm_insert_epi16(_a, _b, _imm)</span>
<a name="l00064"></a><a class="code" href="vsw_8h.html#a2ae3fc7d190865d91f01583c3a666ab7">00064</a> <span class="preprocessor"></span><span class="preprocessor">#define __vsw16_mm_extract_epi16(_a, _imm) _mm_extract_epi16(_a, _imm)</span>
<a name="l00065"></a><a class="code" href="vsw_8h.html#a2c1f3f77111b432e36b18eff029c24d5">00065</a> <span class="preprocessor"></span><span class="preprocessor">#define vsw16_values_per_128_bits 8 </span>
<a name="l00066"></a><a class="code" href="vsw_8h.html#a28d2f2a0b7b9d0ff44bf4b7299776dda">00066</a> <span class="preprocessor"></span><span class="preprocessor">#define vsw16_values_per_128_bits_log2 3 // should be log2(values_per_128_bits)</span>
<a name="l00067"></a><a class="code" href="vsw_8h.html#a9dd1abc8ba73d54839e18372cd1da3a6">00067</a> <span class="preprocessor"></span><span class="preprocessor">#define vsw16_max_value INT16_MAX</span>
<a name="l00068"></a><a class="code" href="vsw_8h.html#a2ba2b8b48622e8e9c7cc2b7257aadebf">00068</a> <span class="preprocessor"></span><span class="preprocessor">#define vsw16_mid_value ((vsw16_max_value &gt;&gt; 1)-1)</span>
<a name="l00069"></a><a class="code" href="vsw_8h.html#ad11b7077dabf1b2f595e469ab2938b22">00069</a> <span class="preprocessor"></span><span class="preprocessor">#define vsw16_min_value INT16_MIN </span>
<a name="l00070"></a><a class="code" href="vsw_8h.html#a18056b629d6788ebc558d0791f14214e">00070</a> <span class="preprocessor"></span><span class="preprocessor">#define vsw16_shift_bytes 2 </span>
<a name="l00071"></a>00071 <span class="preprocessor"></span><span class="comment">//typedef uint16_t vsw16_uint_t;</span>
<a name="l00072"></a><a class="code" href="vsw_8h.html#ab75835e596672ce04de753a4f9d39927">00072</a> <span class="keyword">typedef</span> int16_t <a class="code" href="vsw_8h.html#ab75835e596672ce04de753a4f9d39927">vsw16_int_t</a>;
<a name="l00073"></a>00073 <span class="comment">// returns the number of stripes required given the query length</span>
<a name="l00074"></a><a class="code" href="vsw_8h.html#a1ac88572ba21a9da876bee29ae0c1faa">00074</a> <span class="preprocessor">#define __vsw16_calc_slen(_qlen) (((_qlen) + vsw16_values_per_128_bits - 1) &gt;&gt; vsw16_values_per_128_bits_log2)</span>
<a name="l00075"></a>00075 <span class="preprocessor"></span><span class="comment">// returns the maximum value in stored in the vector</span>
<a name="l00076"></a><a class="code" href="vsw_8h.html#aff8efa4918c27db3fd7fd99216c2badb">00076</a> <span class="preprocessor">#define __vsw16_max(ret, xx) do { \</span>
<a name="l00077"></a>00077 <span class="preprocessor">    (xx) = _mm_max_epi16((xx), _mm_srli_si128((xx), 8)); \</span>
<a name="l00078"></a>00078 <span class="preprocessor">    (xx) = _mm_max_epi16((xx), _mm_srli_si128((xx), 4)); \</span>
<a name="l00079"></a>00079 <span class="preprocessor">    (xx) = _mm_max_epi16((xx), _mm_srli_si128((xx), 2)); \</span>
<a name="l00080"></a>00080 <span class="preprocessor">    (ret) = (vsw16_int_t)(__vsw16_mm_extract_epi16((xx), 0) &amp; 0xffff); \</span>
<a name="l00081"></a>00081 <span class="preprocessor">} while (0) </span>
<a name="l00082"></a>00082 <span class="preprocessor"></span><span class="comment">// returns the minimum value in stored in the vector</span>
<a name="l00083"></a><a class="code" href="vsw_8h.html#a36ec5c5ad9c30e3ebaa8fb87901633aa">00083</a> <span class="preprocessor">#define __vsw16_min(ret, xx) do { \</span>
<a name="l00084"></a>00084 <span class="preprocessor">    (xx) = _mm_min_epi16((xx), _mm_srli_si128((xx), 8)); \</span>
<a name="l00085"></a>00085 <span class="preprocessor">    (xx) = _mm_min_epi16((xx), _mm_srli_si128((xx), 4)); \</span>
<a name="l00086"></a>00086 <span class="preprocessor">    (xx) = _mm_min_epi16((xx), _mm_srli_si128((xx), 2)); \</span>
<a name="l00087"></a>00087 <span class="preprocessor">    (ret) = (vsw16_int_t)(__vsw16_mm_extract_epi16((xx), 0) &amp; 0xffff); \</span>
<a name="l00088"></a>00088 <span class="preprocessor">} while (0) </span>
<a name="l00089"></a>00089 <span class="preprocessor"></span><span class="comment">// Inserts a value into the given location in the vector.  This overcomes the immediate problem when compiling.</span>
<a name="l00090"></a><a class="code" href="vsw_8h.html#a05fc77d93ed58f4dbb029b806a68ca95">00090</a> <span class="preprocessor">#define __vsw16_mm_insert(_a, _val, _k) \</span>
<a name="l00091"></a>00091 <span class="preprocessor">  (0 == _k ? __vsw16_mm_insert_epi16(_a, _val, 0) : \</span>
<a name="l00092"></a>00092 <span class="preprocessor">   (1 == _k ? __vsw16_mm_insert_epi16(_a, _val, 1) : \</span>
<a name="l00093"></a>00093 <span class="preprocessor">    (2 == _k ? __vsw16_mm_insert_epi16(_a, _val, 2) : \</span>
<a name="l00094"></a>00094 <span class="preprocessor">     (3 == _k ? __vsw16_mm_insert_epi16(_a, _val, 3) : \</span>
<a name="l00095"></a>00095 <span class="preprocessor">      (4 == _k ? __vsw16_mm_insert_epi16(_a, _val, 4) : \</span>
<a name="l00096"></a>00096 <span class="preprocessor">       (5 == _k ? __vsw16_mm_insert_epi16(_a, _val, 5) : \</span>
<a name="l00097"></a>00097 <span class="preprocessor">        (6 == _k ? __vsw16_mm_insert_epi16(_a, _val, 6) : \</span>
<a name="l00098"></a>00098 <span class="preprocessor">         (7 == _k ? __vsw16_mm_insert_epi16(_a, _val, 7) : \</span>
<a name="l00099"></a>00099 <span class="preprocessor">          _a))))))))</span>
<a name="l00100"></a>00100 <span class="preprocessor"></span><span class="comment">// returns cell j in the scoring matrix row</span>
<a name="l00101"></a><a class="code" href="vsw_8h.html#a4ec73a578c7974b50f2a43ee0b0b12ad">00101</a> <span class="preprocessor">#define __vsw16_get_matrix_cell1(_Xs, _j, _slen) \</span>
<a name="l00102"></a>00102 <span class="preprocessor">  (((vsw16_int_t*)(_Xs + ((_j) % _slen)))[(_j) / _slen])</span>
<a name="l00103"></a>00103 <span class="preprocessor"></span><span class="comment">// returns cell (i,j) in the scoring matrix</span>
<a name="l00104"></a><a class="code" href="vsw_8h.html#a49b1ab6e51539ec5ea45f339c44148d0">00104</a> <span class="preprocessor">#define __vsw16_get_matrix_cell(_Xs, _slen, _i, _j) \</span>
<a name="l00105"></a>00105 <span class="preprocessor">  __vsw16_get_matrix_cell1(_Xs + ((_i) * _slen), _j, _slen)</span>
<a name="l00106"></a>00106 <span class="preprocessor"></span><span class="comment">// returns the score in the query profile</span>
<a name="l00107"></a><a class="code" href="vsw_8h.html#a90d8634ffc228ba21b2a58013b29caea">00107</a> <span class="preprocessor">#define __vsw16_get_query_profile_value(_query, _base, _j) \</span>
<a name="l00108"></a>00108 <span class="preprocessor">  (((vsw16_int_t*)((_query)-&gt;query_profile + (_base * (_query)-&gt;slen) + ((_j) % (_query)-&gt;slen)))[(_j) / (_query)-&gt;slen])</span>
<a name="l00109"></a>00109 <span class="preprocessor"></span>
<a name="l00111"></a>00111 <span class="comment">// returns the amount of memory the stripes will occupy  (align the memory by 16 bytes)</span>
<a name="l00112"></a><a class="code" href="vsw_8h.html#adc6b1212fa967fa537ab4b8be61bbd4e">00112</a> <span class="preprocessor">#define __vsw_calc_qlen_mem(_slen) __vsw_16((_slen) &lt;&lt; 4) // divide by 16, since there 16 bytes per 128</span>
<a name="l00113"></a>00113 <span class="preprocessor"></span><span class="comment">// zero-based query index to zero-based stripe #</span>
<a name="l00114"></a><a class="code" href="vsw_8h.html#af9d66162e15489505bb519e12db3d7a7">00114</a> <span class="preprocessor">#define __vsw_query_index_to_stripe_number(_q, _slen) ((_q) &amp; _slen) </span>
<a name="l00115"></a>00115 <span class="preprocessor"></span><span class="comment">// zero-based query index to zero-based bit #</span>
<a name="l00116"></a><a class="code" href="vsw_8h.html#ae929fed1749f5fcf658078e8ef642ee2">00116</a> <span class="preprocessor">#define __vsw_query_index_to_byte_number(_q, _slen) (((int32_t)(_q)) / _slen)</span>
<a name="l00117"></a>00117 <span class="preprocessor"></span>
<a name="l00121"></a><a class="code" href="structvsw16__query__t.html">00121</a> <span class="keyword">typedef</span> <span class="keyword">struct </span>{
<a name="l00122"></a><a class="code" href="structvsw16__query__t.html#a04090ebf80ed9254d5b5d9d2d1abe85e">00122</a>     uint8_t query_start_clip:2; 
<a name="l00123"></a><a class="code" href="structvsw16__query__t.html#a4cdb9d6e7e0c38c66c760009a37f035d">00123</a>     uint8_t query_end_clip:2;  
<a name="l00124"></a><a class="code" href="structvsw16__query__t.html#a3352fab3e2d90873ee35388382406488">00124</a>     uint16_t <a class="code" href="structvsw16__query__t.html#a3352fab3e2d90873ee35388382406488">qlen</a>; 
<a name="l00125"></a><a class="code" href="structvsw16__query__t.html#a9028adc5c941cdb7738430560e7e3dc7">00125</a>     uint16_t <a class="code" href="structvsw16__query__t.html#a9028adc5c941cdb7738430560e7e3dc7">tlen</a>; 
<a name="l00126"></a><a class="code" href="structvsw16__query__t.html#a7520a2a3020e37d3010de9727b8420d8">00126</a>     int32_t <a class="code" href="structvsw16__query__t.html#a7520a2a3020e37d3010de9727b8420d8">slen</a>; 
<a name="l00127"></a><a class="code" href="structvsw16__query__t.html#a15e4cecdf4c33120c3e1ef0ac2aa935a">00127</a>     int32_t <a class="code" href="structvsw16__query__t.html#a15e4cecdf4c33120c3e1ef0ac2aa935a">qlen_mem</a>; 
<a name="l00128"></a><a class="code" href="structvsw16__query__t.html#abebfdc7fc2bcbaf4e73f80feb7251c93">00128</a>     <a class="code" href="vsw_8h.html#ab75835e596672ce04de753a4f9d39927">vsw16_int_t</a> <a class="code" href="structvsw16__query__t.html#abebfdc7fc2bcbaf4e73f80feb7251c93">min_edit_score</a>; 
<a name="l00129"></a><a class="code" href="structvsw16__query__t.html#a319e77303fd00dd3dbdb3d5857d6f7b9">00129</a>     <a class="code" href="vsw_8h.html#ab75835e596672ce04de753a4f9d39927">vsw16_int_t</a> <a class="code" href="structvsw16__query__t.html#a319e77303fd00dd3dbdb3d5857d6f7b9">max_edit_score</a>; 
<a name="l00130"></a><a class="code" href="structvsw16__query__t.html#a7296ff735b4e75821ba1b34da8396598">00130</a>     <a class="code" href="vsw_8h.html#ab75835e596672ce04de753a4f9d39927">vsw16_int_t</a> <a class="code" href="structvsw16__query__t.html#a7296ff735b4e75821ba1b34da8396598">zero_aln_score</a>; 
<a name="l00131"></a><a class="code" href="structvsw16__query__t.html#a4833b212ca343d800c1114b3625d7e4c">00131</a>     <a class="code" href="vsw_8h.html#ab75835e596672ce04de753a4f9d39927">vsw16_int_t</a> <a class="code" href="structvsw16__query__t.html#a4833b212ca343d800c1114b3625d7e4c">min_aln_score</a>; 
<a name="l00132"></a><a class="code" href="structvsw16__query__t.html#a6ada34a382a4709886adebf1483295e5">00132</a>     <a class="code" href="vsw_8h.html#ab75835e596672ce04de753a4f9d39927">vsw16_int_t</a> <a class="code" href="structvsw16__query__t.html#a6ada34a382a4709886adebf1483295e5">max_aln_score</a>; 
<a name="l00133"></a><a class="code" href="structvsw16__query__t.html#a63762f060707db3e0eb1e65b2446007f">00133</a>     __m128i *<a class="code" href="structvsw16__query__t.html#a63762f060707db3e0eb1e65b2446007f">query_profile</a>; 
<a name="l00134"></a><a class="code" href="structvsw16__query__t.html#ae0d500b33286fed9a743ec25e0ef0d78">00134</a>     __m128i *<a class="code" href="structvsw16__query__t.html#ae0d500b33286fed9a743ec25e0ef0d78">H0</a>; 
<a name="l00135"></a><a class="code" href="structvsw16__query__t.html#af042ebd78d6c3fa6300b2d2e5d8dabff">00135</a>     __m128i *<a class="code" href="structvsw16__query__t.html#af042ebd78d6c3fa6300b2d2e5d8dabff">H1</a>; 
<a name="l00136"></a><a class="code" href="structvsw16__query__t.html#aea308b5eedf9cbacf8a7895baf3e714d">00136</a>     __m128i *<a class="code" href="structvsw16__query__t.html#aea308b5eedf9cbacf8a7895baf3e714d">E</a>; 
<a name="l00137"></a><a class="code" href="structvsw16__query__t.html#a5124467ea6172bce821af218380a9c81">00137</a>     int32_t <a class="code" href="structvsw16__query__t.html#a5124467ea6172bce821af218380a9c81">qlen_max</a>; 
<a name="l00138"></a>00138 } <a class="code" href="structvsw16__query__t.html">vsw16_query_t</a>;
<a name="l00139"></a>00139 
<a name="l00143"></a><a class="code" href="structvsw__query__t.html">00143</a> <span class="keyword">typedef</span> <span class="keyword">struct </span>{
<a name="l00144"></a><a class="code" href="structvsw__query__t.html#ae9e14d80fa92ca26019c95ad4f89f7b0">00144</a>     <a class="code" href="structvsw16__query__t.html">vsw16_query_t</a> *<a class="code" href="structvsw__query__t.html#ae9e14d80fa92ca26019c95ad4f89f7b0">query16</a>; 
<a name="l00145"></a><a class="code" href="structvsw__query__t.html#a8c9e2941c98550842fadd4fc1989e4ef">00145</a>     <span class="keyword">const</span> uint8_t *<a class="code" href="structvsw__query__t.html#a8c9e2941c98550842fadd4fc1989e4ef">query</a>; <span class="comment">// TMP</span>
<a name="l00146"></a><a class="code" href="structvsw__query__t.html#a46db1ffa5c7b8984612709fa13df1f6e">00146</a>     uint32_t <a class="code" href="structvsw__query__t.html#a46db1ffa5c7b8984612709fa13df1f6e">qlen</a>; <span class="comment">// TMP</span>
<a name="l00147"></a>00147 } <a class="code" href="structvsw__query__t.html">vsw_query_t</a>;
<a name="l00148"></a>00148 
<a name="l00149"></a>00149 <span class="comment">// ACGTN</span>
<a name="l00150"></a><a class="code" href="vsw_8h.html#ac625e8907bc05967e1eeef8b4fc4c4c7">00150</a> <span class="preprocessor">#define VSW_ALPHABET_SIZE 5</span>
<a name="l00151"></a>00151 <span class="preprocessor"></span>
<a name="l00155"></a><a class="code" href="structvsw__opt__t.html">00155</a> <span class="keyword">typedef</span> <span class="keyword">struct </span>{
<a name="l00156"></a><a class="code" href="structvsw__opt__t.html#a92b1e192aefc73c192f7ecd5d021d3bb">00156</a>     int32_t <a class="code" href="structvsw__opt__t.html#a92b1e192aefc73c192f7ecd5d021d3bb">score_match</a>; 
<a name="l00157"></a><a class="code" href="structvsw__opt__t.html#aae638d029f9e771a468e69b2c033601c">00157</a>     int32_t <a class="code" href="structvsw__opt__t.html#aae638d029f9e771a468e69b2c033601c">pen_mm</a>; 
<a name="l00158"></a><a class="code" href="structvsw__opt__t.html#ad86e739a3e55e81bb0d0365a7d277581">00158</a>     int32_t <a class="code" href="structvsw__opt__t.html#ad86e739a3e55e81bb0d0365a7d277581">pen_gapo</a>; 
<a name="l00159"></a><a class="code" href="structvsw__opt__t.html#aaa8cd3dcdfffea5841dc45280a44c4a9">00159</a>     int32_t <a class="code" href="structvsw__opt__t.html#aaa8cd3dcdfffea5841dc45280a44c4a9">pen_gape</a>; 
<a name="l00160"></a><a class="code" href="structvsw__opt__t.html#af8f94586abc8d5ca497b0ba63f109c2e">00160</a>     int32_t <a class="code" href="structvsw__opt__t.html#af8f94586abc8d5ca497b0ba63f109c2e">score_thres</a>; 
<a name="l00161"></a>00161 } <a class="code" href="structvsw__opt__t.html">vsw_opt_t</a>;
<a name="l00162"></a>00162 
<a name="l00163"></a><a class="code" href="structvsw__result__t.html">00163</a> <span class="keyword">typedef</span> <span class="keyword">struct </span>{
<a name="l00164"></a><a class="code" href="structvsw__result__t.html#a6ab10f691f0e5bc29a4db7a2ee05643d">00164</a>     int32_t <a class="code" href="structvsw__result__t.html#a6ab10f691f0e5bc29a4db7a2ee05643d">score_fwd</a>; 
<a name="l00165"></a><a class="code" href="structvsw__result__t.html#a57308a5bef6c148c85df6681117ec152">00165</a>     int32_t <a class="code" href="structvsw__result__t.html#a57308a5bef6c148c85df6681117ec152">score_rev</a>; 
<a name="l00166"></a><a class="code" href="structvsw__result__t.html#a7ba95faebd6db5af9814803c98e7601e">00166</a>     int32_t <a class="code" href="structvsw__result__t.html#a7ba95faebd6db5af9814803c98e7601e">query_start</a>; 
<a name="l00167"></a><a class="code" href="structvsw__result__t.html#aa83d68d2f1e463a2948ebf63866252ae">00167</a>     int32_t <a class="code" href="structvsw__result__t.html#aa83d68d2f1e463a2948ebf63866252ae">query_end</a>; 
<a name="l00168"></a><a class="code" href="structvsw__result__t.html#ad0c2238dfdbc54734c4c39840dcea3d7">00168</a>     int32_t <a class="code" href="structvsw__result__t.html#ad0c2238dfdbc54734c4c39840dcea3d7">target_start</a>; 
<a name="l00169"></a><a class="code" href="structvsw__result__t.html#ab2f54501c1c35713a50c6d1600bf7c7b">00169</a>     int32_t <a class="code" href="structvsw__result__t.html#ab2f54501c1c35713a50c6d1600bf7c7b">target_end</a>; 
<a name="l00170"></a>00170 } <a class="code" href="structvsw__result__t.html">vsw_result_t</a>;
<a name="l00171"></a>00171 
<a name="l00180"></a>00180 <a class="code" href="structvsw__opt__t.html">vsw_opt_t</a>*
<a name="l00181"></a>00181 <a class="code" href="vsw_8h.html#a3426651b68cb709981065376f58273cb">vsw_opt_init</a>(int32_t score_match, int32_t pen_mm, int32_t pen_gapo, int32_t pen_gape, int32_t score_thr);
<a name="l00182"></a>00182 
<a name="l00186"></a>00186 <span class="keywordtype">void</span>
<a name="l00187"></a>00187 <a class="code" href="vsw_8h.html#aaea76c97f4ed46ce229fa14bf37104ba">vsw_opt_destroy</a>(<a class="code" href="structvsw__opt__t.html">vsw_opt_t</a> *opt);
<a name="l00188"></a>00188 
<a name="l00198"></a>00198 <a class="code" href="structvsw__query__t.html">vsw_query_t</a>*
<a name="l00199"></a>00199 <a class="code" href="vsw_8h.html#a0e155cf32a07379f1a3754ee065f266e">vsw_query_init</a>(<span class="keyword">const</span> uint8_t *query, int32_t qlen,
<a name="l00200"></a>00200                     int32_t tlen,
<a name="l00201"></a>00201                     int32_t query_start_clip, int32_t query_end_clip,
<a name="l00202"></a>00202                     <a class="code" href="structvsw__opt__t.html">vsw_opt_t</a> *opt);
<a name="l00203"></a>00203 
<a name="l00207"></a>00207 <span class="keywordtype">void</span>
<a name="l00208"></a>00208 <a class="code" href="vsw_8h.html#a08735f9797f1f672c5b7534a83e35799">vsw_query_destroy</a>(<a class="code" href="structvsw__query__t.html">vsw_query_t</a> *query);
<a name="l00209"></a>00209 
<a name="l00231"></a>00231 int32_t
<a name="l00232"></a>00232 <a class="code" href="vsw_8h.html#a5bbd1d9696fb27bafd8b29ff488ca2e0">vsw_sse2</a>(<a class="code" href="structvsw__query__t.html">vsw_query_t</a> *vsw_query,
<a name="l00233"></a>00233               <span class="keyword">const</span> uint8_t *query, int32_t qlen,
<a name="l00234"></a>00234               uint8_t *target, int32_t tlen,
<a name="l00235"></a>00235               int32_t query_start_clip, int32_t query_end_clip,
<a name="l00236"></a>00236               <a class="code" href="structvsw__opt__t.html">vsw_opt_t</a> *opt, 
<a name="l00237"></a>00237               int16_t *score_fwd, int16_t *score_rev,
<a name="l00238"></a>00238               int16_t *query_start, int16_t *query_end,
<a name="l00239"></a>00239               int16_t *target_start, int16_t *target_end,
<a name="l00240"></a>00240               int32_t *overflow, int32_t *n_best, int32_t score_thr, int32_t is_rev);
<a name="l00241"></a>00241 
<a name="l00242"></a>00242 <span class="preprocessor">#endif</span>
</pre></div></div>
</div>


<hr class="footer"/><address class="footer"><small>
Generated on Wed Jun 13 2012 15:47:07 for TMAP by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.7.5.1
</small></address>

</body>
</html>
