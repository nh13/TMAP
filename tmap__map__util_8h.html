<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>TMAP: /Users/nilshomer/git/tmap/src/map/util/tmap_map_util.h File Reference</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />



</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">TMAP
   &#160;<span id="projectnumber">2.3.3</span>
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.5.1 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="dir_15187882eb12136f52a6e42c6006d23a.html">src</a>      </li>
      <li class="navelem"><a class="el" href="dir_5fec67adcc529529b6e0865c48f0f333.html">map</a>      </li>
      <li class="navelem"><a class="el" href="dir_13ee51cfc58103d1f47485f9bedbae71.html">util</a>      </li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Defines</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">tmap_map_util.h File Reference</div>  </div>
</div>
<div class="contents">
<div class="textblock"><code>#include &lt;sys/types.h&gt;</code><br/>
<code>#include &quot;../../util/tmap_rand.h&quot;</code><br/>
<code>#include &quot;../../sw/tmap_fsw.h&quot;</code><br/>
<code>#include &quot;../../sw/tmap_vsw.h&quot;</code><br/>
<code>#include &quot;<a class="el" href="tmap__map__opt_8h_source.html">tmap_map_opt.h</a>&quot;</code><br/>
</div>
<p><a href="tmap__map__util_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structtmap__map__map1__aux__t.html">tmap_map_map1_aux_t</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structtmap__map__map2__aux__t.html">tmap_map_map2_aux_t</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structtmap__map__map3__aux__t.html">tmap_map_map3_aux_t</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structtmap__map__map4__aux__t.html">tmap_map_map4_aux_t</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structtmap__map__map__vsw__aux__t.html">tmap_map_map_vsw_aux_t</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structtmap__map__sam__t.html">tmap_map_sam_t</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structtmap__map__sams__t.html">tmap_map_sams_t</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structtmap__map__record__t.html">tmap_map_record_t</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structtmap__map__bam__t.html">tmap_map_bam_t</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structtmap__map__bams__t.html">tmap_map_bams_t</a></td></tr>
<tr><td colspan="2"><h2><a name="define-members"></a>
Defines</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tmap__map__util_8h.html#af6457fcb4108325c4894a6c8d98cfecb">__map_util_gen_ap</a>(par, opt)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tmap__map__util_8h.html#a6322a3c402a0327a8d7dcf6e5c7ff35a">__tmap_map_util_reverse_soft_clipping</a>(_sc)</td></tr>
<tr><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tmap__map__util_8h.html#a7aa191907bfa3755065c499412f9389c">tmap_map_sam_init</a> (<a class="el" href="structtmap__map__sam__t.html">tmap_map_sam_t</a> *s)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tmap__map__util_8h.html#adbf5ba2771cd111637ddd4a66755e5bd">tmap_map_sam_copy</a> (<a class="el" href="structtmap__map__sam__t.html">tmap_map_sam_t</a> *dest, <a class="el" href="structtmap__map__sam__t.html">tmap_map_sam_t</a> *src)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tmap__map__util_8h.html#a20002739d1f1594590ab76c92d9670c0">tmap_map_sam_malloc_aux</a> (<a class="el" href="structtmap__map__sam__t.html">tmap_map_sam_t</a> *s)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tmap__map__util_8h.html#abf5df8691636222e7a177c163e60c760">tmap_map_sam_destroy_aux</a> (<a class="el" href="structtmap__map__sam__t.html">tmap_map_sam_t</a> *s)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tmap__map__util_8h.html#a8b68ae998672c9e174595d1e3e563fc6">tmap_map_sam_destroy</a> (<a class="el" href="structtmap__map__sam__t.html">tmap_map_sam_t</a> *s)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="structtmap__map__sams__t.html">tmap_map_sams_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tmap__map__util_8h.html#acd77ba878c8710dce292b71b94225927">tmap_map_sams_init</a> (<a class="el" href="structtmap__map__sams__t.html">tmap_map_sams_t</a> *prev)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tmap__map__util_8h.html#aeafeda2a5b43e7f67cf021ddea3f5fb3">tmap_map_sams_realloc</a> (<a class="el" href="structtmap__map__sams__t.html">tmap_map_sams_t</a> *s, int32_t n)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tmap__map__util_8h.html#a936fef3636f03c32ab5965530fdc38b0">tmap_map_sams_destroy</a> (<a class="el" href="structtmap__map__sams__t.html">tmap_map_sams_t</a> *s)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="structtmap__map__record__t.html">tmap_map_record_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tmap__map__util_8h.html#a38f68d01eb9d7e3861eac4e4ab20f247">tmap_map_record_init</a> (int32_t num_ends)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="structtmap__map__record__t.html">tmap_map_record_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tmap__map__util_8h.html#a506344a6f88ade27f3f2272e21b653b4">tmap_map_record_clone</a> (<a class="el" href="structtmap__map__record__t.html">tmap_map_record_t</a> *src)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tmap__map__util_8h.html#a496a1833599f60c2be19c5b78c92d873">tmap_map_record_merge</a> (<a class="el" href="structtmap__map__record__t.html">tmap_map_record_t</a> *dest, <a class="el" href="structtmap__map__record__t.html">tmap_map_record_t</a> *src)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tmap__map__util_8h.html#ab5bc4128118e3b77cd96e3c261b8a122">tmap_map_record_destroy</a> (<a class="el" href="structtmap__map__record__t.html">tmap_map_record_t</a> *record)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="structtmap__map__bam__t.html">tmap_map_bam_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tmap__map__util_8h.html#a45849675491bd7095c30492694b23877">tmap_map_bam_init</a> (int32_t n)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tmap__map__util_8h.html#a1c4266b681d625f3761e2e8f0d6d1f7e">tmap_map_bam_destroy</a> (<a class="el" href="structtmap__map__bam__t.html">tmap_map_bam_t</a> *b)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="structtmap__map__bams__t.html">tmap_map_bams_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tmap__map__util_8h.html#a3e8e0c1aca652d75ecb31dc40147ccfa">tmap_map_bams_init</a> (int32_t n)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tmap__map__util_8h.html#ad92da48a24ee2c05f180cbda18b72f5d">tmap_map_bams_destroy</a> (<a class="el" href="structtmap__map__bams__t.html">tmap_map_bams_t</a> *b)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tmap__map__util_8h.html#a37393f7766ba93977194ceef899919a1">tmap_map_sams_merge</a> (<a class="el" href="structtmap__map__sams__t.html">tmap_map_sams_t</a> *dest, <a class="el" href="structtmap__map__sams__t.html">tmap_map_sams_t</a> *src)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="structtmap__map__sams__t.html">tmap_map_sams_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tmap__map__util_8h.html#a9deb9a26c412e99d7c49b6a75e546268">tmap_map_sams_clone</a> (<a class="el" href="structtmap__map__sams__t.html">tmap_map_sams_t</a> *src)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tmap__map__util_8h.html#a5417ca7496bb0c9b3713cef076e3b52e">tmap_map_sam_copy_and_nullify</a> (<a class="el" href="structtmap__map__sam__t.html">tmap_map_sam_t</a> *dest, <a class="el" href="structtmap__map__sam__t.html">tmap_map_sam_t</a> *src)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="structtmap__map__bam__t.html">tmap_map_bam_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tmap__map__util_8h.html#a92cdeae7cee8644f0c218b6975586311">tmap_map_sams_print</a> (<a class="el" href="structtmap__seq__t.html">tmap_seq_t</a> *seq, <a class="el" href="structtmap__refseq__t.html">tmap_refseq_t</a> *refseq, <a class="el" href="structtmap__map__sams__t.html">tmap_map_sams_t</a> *sams, int32_t end_num, <a class="el" href="structtmap__map__sams__t.html">tmap_map_sams_t</a> *mates, int32_t sam_flowspace_tags, int32_t bidirectional, int32_t seq_eq)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tmap__map__util_8h.html#aad92a8ad7219092696c1ab292918fc00">tmap_map_util_keep_score</a> (<a class="el" href="structtmap__map__sams__t.html">tmap_map_sams_t</a> *sams, int32_t algo_id, int32_t score)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tmap__map__util_8h.html#a51eac705dd32f8644bb0ad30601fe639">tmap_map_sams_filter</a> (<a class="el" href="structtmap__map__sams__t.html">tmap_map_sams_t</a> *sams, int32_t aln_output_mode, <a class="el" href="structtmap__rand__t.html">tmap_rand_t</a> *rand)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tmap__map__util_8h.html#a5fb5437fd6ee16970a361718d1ad460d">tmap_map_sams_filter1</a> (<a class="el" href="structtmap__map__sams__t.html">tmap_map_sams_t</a> *sams, int32_t aln_output_mode, int32_t algo_id, <a class="el" href="structtmap__rand__t.html">tmap_rand_t</a> *rand)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tmap__map__util_8h.html#ae9fc314471bfc45617d0aab424b03535">tmap_map_sams_filter2</a> (<a class="el" href="structtmap__map__sams__t.html">tmap_map_sams_t</a> *sams, int32_t score_thr, int32_t mapq_thr)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tmap__map__util_8h.html#af60c1af840d0135043ca79a2979c8cdf">tmap_map_util_remove_duplicates</a> (<a class="el" href="structtmap__map__sams__t.html">tmap_map_sams_t</a> *sams, int32_t dup_window, <a class="el" href="structtmap__rand__t.html">tmap_rand_t</a> *rand)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tmap__map__util_8h.html#addaad04dd46c228c12e78650f3b17a19">tmap_map_util_mapq_score</a> (int32_t seq_len, int32_t n_best, int32_t best_score, int32_t n_best_subo, int32_t best_subo_score, <a class="el" href="structtmap__map__opt__t.html">tmap_map_opt_t</a> *opt)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tmap__map__util_8h.html#a28786a41d73e0699138041d4c24b5b0d">tmap_map_util_mapq</a> (<a class="el" href="structtmap__map__sams__t.html">tmap_map_sams_t</a> *sams, int32_t seq_len, <a class="el" href="structtmap__map__opt__t.html">tmap_map_opt_t</a> *opt)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="structtmap__map__sams__t.html">tmap_map_sams_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tmap__map__util_8h.html#a66130a453a429b8c0139707aa73a94a3">tmap_map_util_sw_gen_score</a> (<a class="el" href="structtmap__refseq__t.html">tmap_refseq_t</a> *refseq, <a class="el" href="structtmap__map__sams__t.html">tmap_map_sams_t</a> *sams, <a class="el" href="structtmap__seq__t.html">tmap_seq_t</a> **seqs, <a class="el" href="structtmap__rand__t.html">tmap_rand_t</a> *rand, <a class="el" href="structtmap__map__opt__t.html">tmap_map_opt_t</a> *opt)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="structtmap__map__sams__t.html">tmap_map_sams_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tmap__map__util_8h.html#aa138c1cd21a069836eb8c4d69603fc41">tmap_map_util_sw_gen_cigar</a> (<a class="el" href="structtmap__refseq__t.html">tmap_refseq_t</a> *refseq, <a class="el" href="structtmap__map__sams__t.html">tmap_map_sams_t</a> *sams, <a class="el" href="structtmap__seq__t.html">tmap_seq_t</a> **seqs, <a class="el" href="structtmap__map__opt__t.html">tmap_map_opt_t</a> *opt)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tmap__map__util_8h.html#adbc4253b379fb84b5037cdadf650ab78">tmap_map_util_fsw</a> (<a class="el" href="structtmap__seq__t.html">tmap_seq_t</a> *seq, <a class="el" href="structtmap__map__sams__t.html">tmap_map_sams_t</a> *sams, <a class="el" href="structtmap__refseq__t.html">tmap_refseq_t</a> *refseq, int32_t bw, int32_t softclip_type, int32_t score_thr, int32_t score_match, int32_t pen_mm, int32_t pen_gapo, int32_t pen_gape, int32_t fscore, int32_t use_flowgram)</td></tr>
</table>
<hr/><h2>Define Documentation</h2>
<a class="anchor" id="af6457fcb4108325c4894a6c8d98cfecb"></a><!-- doxytag: member="tmap_map_util.h::__map_util_gen_ap" ref="af6457fcb4108325c4894a6c8d98cfecb" args="(par, opt)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define __map_util_gen_ap</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">par, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">opt&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<b>Value:</b><div class="fragment"><pre class="fragment"><span class="keywordflow">do</span> { \
    int32_t i; \
    for(i=0;i&lt;25;i++) { \
        (par).matrix[i] = -(opt)-&gt;pen_mm; \
    } \
    for(i=0;i&lt;4;i++) { \
        (par).matrix[i*5+i] = (opt)-&gt;score_match; \
    } \
    (par).gap_open = (opt)-&gt;pen_gapo; (par).gap_ext = (opt)-&gt;pen_gape; \
    (par).gap_end = (opt)-&gt;pen_gape; \
    (par).row = 5; \
    (par).band_width = (opt)-&gt;bw; \
} <span class="keywordflow">while</span>(0)
</pre></div>
</div>
</div>
<a class="anchor" id="a6322a3c402a0327a8d7dcf6e5c7ff35a"></a><!-- doxytag: member="tmap_map_util.h::__tmap_map_util_reverse_soft_clipping" ref="a6322a3c402a0327a8d7dcf6e5c7ff35a" args="(_sc)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define __tmap_map_util_reverse_soft_clipping</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">_sc</td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<b>Value:</b><div class="fragment"><pre class="fragment">(((_sc) == <a class="code" href="tmap__map__opt_8h.html#a726ca809ffd3d67ab4b8476646f26635a1e4bf53d289770ba5b70be93be6d8c45">TMAP_MAP_OPT_SOFT_CLIP_LEFT</a>) ? \
   TMAP_MAP_OPT_SOFT_CLIP_RIGHT : \
   (((_sc) == <a class="code" href="tmap__map__opt_8h.html#a726ca809ffd3d67ab4b8476646f26635a17b5877fddf950c90b1c76f195f1df3e">TMAP_MAP_OPT_SOFT_CLIP_RIGHT</a>) ? \
    TMAP_MAP_OPT_SOFT_CLIP_LEFT : (_sc)))
</pre></div>
</div>
</div>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="a1c4266b681d625f3761e2e8f0d6d1f7e"></a><!-- doxytag: member="tmap_map_util.h::tmap_map_bam_destroy" ref="a1c4266b681d625f3761e2e8f0d6d1f7e" args="(tmap_map_bam_t *b)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void tmap_map_bam_destroy </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structtmap__map__bam__t.html">tmap_map_bam_t</a> *&#160;</td>
          <td class="paramname"><em>b</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a45849675491bd7095c30492694b23877"></a><!-- doxytag: member="tmap_map_util.h::tmap_map_bam_init" ref="a45849675491bd7095c30492694b23877" args="(int32_t n)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structtmap__map__bam__t.html">tmap_map_bam_t</a>* tmap_map_bam_init </td>
          <td>(</td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>n</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="ad92da48a24ee2c05f180cbda18b72f5d"></a><!-- doxytag: member="tmap_map_util.h::tmap_map_bams_destroy" ref="ad92da48a24ee2c05f180cbda18b72f5d" args="(tmap_map_bams_t *b)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void tmap_map_bams_destroy </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structtmap__map__bams__t.html">tmap_map_bams_t</a> *&#160;</td>
          <td class="paramname"><em>b</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a3e8e0c1aca652d75ecb31dc40147ccfa"></a><!-- doxytag: member="tmap_map_util.h::tmap_map_bams_init" ref="a3e8e0c1aca652d75ecb31dc40147ccfa" args="(int32_t n)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structtmap__map__bams__t.html">tmap_map_bams_t</a>* tmap_map_bams_init </td>
          <td>(</td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>n</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a506344a6f88ade27f3f2272e21b653b4"></a><!-- doxytag: member="tmap_map_util.h::tmap_map_record_clone" ref="a506344a6f88ade27f3f2272e21b653b4" args="(tmap_map_record_t *src)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structtmap__map__record__t.html">tmap_map_record_t</a>* tmap_map_record_clone </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structtmap__map__record__t.html">tmap_map_record_t</a> *&#160;</td>
          <td class="paramname"><em>src</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Clones a new multi-end mapping structure </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">src</td><td>the multi-end mapping structure to clone </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>the new multi-end mapping structure </dd></dl>

</div>
</div>
<a class="anchor" id="ab5bc4128118e3b77cd96e3c261b8a122"></a><!-- doxytag: member="tmap_map_util.h::tmap_map_record_destroy" ref="ab5bc4128118e3b77cd96e3c261b8a122" args="(tmap_map_record_t *record)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void tmap_map_record_destroy </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structtmap__map__record__t.html">tmap_map_record_t</a> *&#160;</td>
          <td class="paramname"><em>record</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Destroys a record structure </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">record</td><td>the mapping structure </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a38f68d01eb9d7e3861eac4e4ab20f247"></a><!-- doxytag: member="tmap_map_util.h::tmap_map_record_init" ref="a38f68d01eb9d7e3861eac4e4ab20f247" args="(int32_t num_ends)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structtmap__map__record__t.html">tmap_map_record_t</a>* tmap_map_record_init </td>
          <td>(</td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>num_ends</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Initializes a new multi-end mapping structure </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">num_ends</td><td>the number of ends in this record </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>the new multi-end mapping structure </dd></dl>

</div>
</div>
<a class="anchor" id="a496a1833599f60c2be19c5b78c92d873"></a><!-- doxytag: member="tmap_map_util.h::tmap_map_record_merge" ref="a496a1833599f60c2be19c5b78c92d873" args="(tmap_map_record_t *dest, tmap_map_record_t *src)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void tmap_map_record_merge </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structtmap__map__record__t.html">tmap_map_record_t</a> *&#160;</td>
          <td class="paramname"><em>dest</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structtmap__map__record__t.html">tmap_map_record_t</a> *&#160;</td>
          <td class="paramname"><em>src</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Merges the mappings of two multi-end mappings </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">src</td><td>the multi-end mapping structure destination </td></tr>
    <tr><td class="paramname">dest</td><td>the multi-end mapping structure to merge from </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="adbf5ba2771cd111637ddd4a66755e5bd"></a><!-- doxytag: member="tmap_map_util.h::tmap_map_sam_copy" ref="adbf5ba2771cd111637ddd4a66755e5bd" args="(tmap_map_sam_t *dest, tmap_map_sam_t *src)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void tmap_map_sam_copy </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structtmap__map__sam__t.html">tmap_map_sam_t</a> *&#160;</td>
          <td class="paramname"><em>dest</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structtmap__map__sam__t.html">tmap_map_sam_t</a> *&#160;</td>
          <td class="paramname"><em>src</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>make a copy of src and store it in dest </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">dest</td><td>the destination record </td></tr>
    <tr><td class="paramname">src</td><td>the source record </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a5417ca7496bb0c9b3713cef076e3b52e"></a><!-- doxytag: member="tmap_map_util.h::tmap_map_sam_copy_and_nullify" ref="a5417ca7496bb0c9b3713cef076e3b52e" args="(tmap_map_sam_t *dest, tmap_map_sam_t *src)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void tmap_map_sam_copy_and_nullify </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structtmap__map__sam__t.html">tmap_map_sam_t</a> *&#160;</td>
          <td class="paramname"><em>dest</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structtmap__map__sam__t.html">tmap_map_sam_t</a> *&#160;</td>
          <td class="paramname"><em>src</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>copies the source into the destination, nullifying the source </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">dest</td><td>the destination mapping structure </td></tr>
    <tr><td class="paramname">src</td><td>the source mapping structure </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a8b68ae998672c9e174595d1e3e563fc6"></a><!-- doxytag: member="tmap_map_util.h::tmap_map_sam_destroy" ref="a8b68ae998672c9e174595d1e3e563fc6" args="(tmap_map_sam_t *s)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void tmap_map_sam_destroy </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structtmap__map__sam__t.html">tmap_map_sam_t</a> *&#160;</td>
          <td class="paramname"><em>s</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>destroys the given mapping structure, including auxiliary data </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">s</td><td>the mapping structure </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="abf5df8691636222e7a177c163e60c760"></a><!-- doxytag: member="tmap_map_util.h::tmap_map_sam_destroy_aux" ref="abf5df8691636222e7a177c163e60c760" args="(tmap_map_sam_t *s)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void tmap_map_sam_destroy_aux </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structtmap__map__sam__t.html">tmap_map_sam_t</a> *&#160;</td>
          <td class="paramname"><em>s</em></td><td>)</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>destroys auxiliary data for the given mapping structure </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">s</td><td>the mapping structure </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a7aa191907bfa3755065c499412f9389c"></a><!-- doxytag: member="tmap_map_util.h::tmap_map_sam_init" ref="a7aa191907bfa3755065c499412f9389c" args="(tmap_map_sam_t *s)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void tmap_map_sam_init </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structtmap__map__sam__t.html">tmap_map_sam_t</a> *&#160;</td>
          <td class="paramname"><em>s</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>initializes </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">s</td><td>the mapping structure </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a20002739d1f1594590ab76c92d9670c0"></a><!-- doxytag: member="tmap_map_util.h::tmap_map_sam_malloc_aux" ref="a20002739d1f1594590ab76c92d9670c0" args="(tmap_map_sam_t *s)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void tmap_map_sam_malloc_aux </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structtmap__map__sam__t.html">tmap_map_sam_t</a> *&#160;</td>
          <td class="paramname"><em>s</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>allocates memory for the auxiliary data specific to the algorithm specified by algo_id </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">s</td><td>the mapping structurem </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a9deb9a26c412e99d7c49b6a75e546268"></a><!-- doxytag: member="tmap_map_util.h::tmap_map_sams_clone" ref="a9deb9a26c412e99d7c49b6a75e546268" args="(tmap_map_sams_t *src)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structtmap__map__sams__t.html">tmap_map_sams_t</a>* tmap_map_sams_clone </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structtmap__map__sams__t.html">tmap_map_sams_t</a> *&#160;</td>
          <td class="paramname"><em>src</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>clones src </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">src</td><td>the source mapping structure </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a936fef3636f03c32ab5965530fdc38b0"></a><!-- doxytag: member="tmap_map_util.h::tmap_map_sams_destroy" ref="a936fef3636f03c32ab5965530fdc38b0" args="(tmap_map_sams_t *s)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void tmap_map_sams_destroy </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structtmap__map__sams__t.html">tmap_map_sams_t</a> *&#160;</td>
          <td class="paramname"><em>s</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>destroys memory associated with these mappings </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">s</td><td>the mapping structure </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a51eac705dd32f8644bb0ad30601fe639"></a><!-- doxytag: member="tmap_map_util.h::tmap_map_sams_filter" ref="a51eac705dd32f8644bb0ad30601fe639" args="(tmap_map_sams_t *sams, int32_t aln_output_mode, tmap_rand_t *rand)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void tmap_map_sams_filter </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structtmap__map__sams__t.html">tmap_map_sams_t</a> *&#160;</td>
          <td class="paramname"><em>sams</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>aln_output_mode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structtmap__rand__t.html">tmap_rand_t</a> *&#160;</td>
          <td class="paramname"><em>rand</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>filters mappings based on the output mode </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">sams</td><td>the mappings to filter </td></tr>
    <tr><td class="paramname">aln_output_mode</td><td>the output mode </td></tr>
    <tr><td class="paramname">rand</td><td>the random number generator </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a5fb5437fd6ee16970a361718d1ad460d"></a><!-- doxytag: member="tmap_map_util.h::tmap_map_sams_filter1" ref="a5fb5437fd6ee16970a361718d1ad460d" args="(tmap_map_sams_t *sams, int32_t aln_output_mode, int32_t algo_id, tmap_rand_t *rand)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void tmap_map_sams_filter1 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structtmap__map__sams__t.html">tmap_map_sams_t</a> *&#160;</td>
          <td class="paramname"><em>sams</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>aln_output_mode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>algo_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structtmap__rand__t.html">tmap_rand_t</a> *&#160;</td>
          <td class="paramname"><em>rand</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>filters mappings based on the output mode </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">sams</td><td>the mappings to filter </td></tr>
    <tr><td class="paramname">aln_output_mode</td><td>the output mode </td></tr>
    <tr><td class="paramname">algo_id</td><td>the algorithm identifier </td></tr>
    <tr><td class="paramname">rand</td><td>the random number generator only filters mappings based on the algorithm id (none process all) </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ae9fc314471bfc45617d0aab424b03535"></a><!-- doxytag: member="tmap_map_util.h::tmap_map_sams_filter2" ref="ae9fc314471bfc45617d0aab424b03535" args="(tmap_map_sams_t *sams, int32_t score_thr, int32_t mapq_thr)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void tmap_map_sams_filter2 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structtmap__map__sams__t.html">tmap_map_sams_t</a> *&#160;</td>
          <td class="paramname"><em>sams</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>score_thr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>mapq_thr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>filters mappings that pass both the scoring and mapping quality thresholds </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">sams</td><td>the mappings to filter </td></tr>
    <tr><td class="paramname">score_thr</td><td>the score threshold </td></tr>
    <tr><td class="paramname">mapq_thr</td><td>the mapping quality threshold </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="acd77ba878c8710dce292b71b94225927"></a><!-- doxytag: member="tmap_map_util.h::tmap_map_sams_init" ref="acd77ba878c8710dce292b71b94225927" args="(tmap_map_sams_t *prev)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structtmap__map__sams__t.html">tmap_map_sams_t</a>* tmap_map_sams_init </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structtmap__map__sams__t.html">tmap_map_sams_t</a> *&#160;</td>
          <td class="paramname"><em>prev</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>allocate memory for an empty mapping structure, with no auxiliary data </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">prev</td><td>copies over the max from prev </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>a pointer to the initialized memory </dd></dl>

</div>
</div>
<a class="anchor" id="a37393f7766ba93977194ceef899919a1"></a><!-- doxytag: member="tmap_map_util.h::tmap_map_sams_merge" ref="a37393f7766ba93977194ceef899919a1" args="(tmap_map_sams_t *dest, tmap_map_sams_t *src)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void tmap_map_sams_merge </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structtmap__map__sams__t.html">tmap_map_sams_t</a> *&#160;</td>
          <td class="paramname"><em>dest</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structtmap__map__sams__t.html">tmap_map_sams_t</a> *&#160;</td>
          <td class="paramname"><em>src</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>merges src into dest </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">dest</td><td>the destination mapping structure </td></tr>
    <tr><td class="paramname">src</td><td>the source mapping structure </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a92cdeae7cee8644f0c218b6975586311"></a><!-- doxytag: member="tmap_map_util.h::tmap_map_sams_print" ref="a92cdeae7cee8644f0c218b6975586311" args="(tmap_seq_t *seq, tmap_refseq_t *refseq, tmap_map_sams_t *sams, int32_t end_num, tmap_map_sams_t *mates, int32_t sam_flowspace_tags, int32_t bidirectional, int32_t seq_eq)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structtmap__map__bam__t.html">tmap_map_bam_t</a>* tmap_map_sams_print </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structtmap__seq__t.html">tmap_seq_t</a> *&#160;</td>
          <td class="paramname"><em>seq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structtmap__refseq__t.html">tmap_refseq_t</a> *&#160;</td>
          <td class="paramname"><em>refseq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structtmap__map__sams__t.html">tmap_map_sams_t</a> *&#160;</td>
          <td class="paramname"><em>sams</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>end_num</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structtmap__map__sams__t.html">tmap_map_sams_t</a> *&#160;</td>
          <td class="paramname"><em>mates</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>sam_flowspace_tags</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>bidirectional</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>seq_eq</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>converts the alignment record to SAM/BAM records </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">seq</td><td>the original read sequence </td></tr>
    <tr><td class="paramname">refseq</td><td>the reference sequence </td></tr>
    <tr><td class="paramname">sams</td><td>the mappings to print </td></tr>
    <tr><td class="paramname">end_num</td><td>0 if there is no mate, 1 if this is the first fragment, 2 if the this is the last fragment </td></tr>
    <tr><td class="paramname">mates</td><td>the mate's mappings, NULL if there is no mate </td></tr>
    <tr><td class="paramname">sam_flowspace_tags</td><td>1 if SFF specific SAM tags are to be outputted, 0 otherwise </td></tr>
    <tr><td class="paramname">bidirectional</td><td>1 if a bidirectional SAM tag is to be added, 0 otherwise </td></tr>
    <tr><td class="paramname">seq_eq</td><td>1 if the SEQ field is to use '=' symbols, 0 otherwise </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>the BAM records for this read </dd></dl>

</div>
</div>
<a class="anchor" id="aeafeda2a5b43e7f67cf021ddea3f5fb3"></a><!-- doxytag: member="tmap_map_util.h::tmap_map_sams_realloc" ref="aeafeda2a5b43e7f67cf021ddea3f5fb3" args="(tmap_map_sams_t *s, int32_t n)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void tmap_map_sams_realloc </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structtmap__map__sams__t.html">tmap_map_sams_t</a> *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>n</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>reallocate memory for mapping structures; does not allocate auxiliary data </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">s</td><td>the mapping structure </td></tr>
    <tr><td class="paramname">n</td><td>the new number of mappings </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="adbc4253b379fb84b5037cdadf650ab78"></a><!-- doxytag: member="tmap_map_util.h::tmap_map_util_fsw" ref="adbc4253b379fb84b5037cdadf650ab78" args="(tmap_seq_t *seq, tmap_map_sams_t *sams, tmap_refseq_t *refseq, int32_t bw, int32_t softclip_type, int32_t score_thr, int32_t score_match, int32_t pen_mm, int32_t pen_gapo, int32_t pen_gape, int32_t fscore, int32_t use_flowgram)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int32_t tmap_map_util_fsw </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structtmap__seq__t.html">tmap_seq_t</a> *&#160;</td>
          <td class="paramname"><em>seq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structtmap__map__sams__t.html">tmap_map_sams_t</a> *&#160;</td>
          <td class="paramname"><em>sams</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structtmap__refseq__t.html">tmap_refseq_t</a> *&#160;</td>
          <td class="paramname"><em>refseq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>bw</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>softclip_type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>score_thr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>score_match</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>pen_mm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>pen_gapo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>pen_gape</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>fscore</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>use_flowgram</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>re-aligns mappings in flow space </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">seq</td><td>the seq read sequence </td></tr>
    <tr><td class="paramname">sams</td><td>the mappings to adjust </td></tr>
    <tr><td class="paramname">refseq</td><td>the reference sequence </td></tr>
    <tr><td class="paramname">bw</td><td>the band width </td></tr>
    <tr><td class="paramname">softclip_type</td><td>the soft clip type </td></tr>
    <tr><td class="paramname">score_thr</td><td>the alignment score threshold </td></tr>
    <tr><td class="paramname">score_match</td><td>the match score </td></tr>
    <tr><td class="paramname">pen_mm</td><td>the mismatch penalty </td></tr>
    <tr><td class="paramname">pen_gapo</td><td>the gap open penalty </td></tr>
    <tr><td class="paramname">pen_gape</td><td>the gap extension penalty </td></tr>
    <tr><td class="paramname">fscore</td><td>the flow penalty </td></tr>
    <tr><td class="paramname">use_flowgram</td><td>1 to use the flowgram if available, 0 otherwise </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>1 if successful, 0 otherwise </dd></dl>

</div>
</div>
<a class="anchor" id="aad92a8ad7219092696c1ab292918fc00"></a><!-- doxytag: member="tmap_map_util.h::tmap_map_util_keep_score" ref="aad92a8ad7219092696c1ab292918fc00" args="(tmap_map_sams_t *sams, int32_t algo_id, int32_t score)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void tmap_map_util_keep_score </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structtmap__map__sams__t.html">tmap_map_sams_t</a> *&#160;</td>
          <td class="paramname"><em>sams</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>algo_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>score</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>keep only the mappings with the given score </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">sams</td><td>the mappings to keep </td></tr>
    <tr><td class="paramname">algo_id</td><td>the algorithm identifier </td></tr>
    <tr><td class="paramname">score</td><td>the score to keep </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a28786a41d73e0699138041d4c24b5b0d"></a><!-- doxytag: member="tmap_map_util.h::tmap_map_util_mapq" ref="a28786a41d73e0699138041d4c24b5b0d" args="(tmap_map_sams_t *sams, int32_t seq_len, tmap_map_opt_t *opt)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int32_t tmap_map_util_mapq </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structtmap__map__sams__t.html">tmap_map_sams_t</a> *&#160;</td>
          <td class="paramname"><em>sams</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>seq_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structtmap__map__opt__t.html">tmap_map_opt_t</a> *&#160;</td>
          <td class="paramname"><em>opt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Computes the mapping quality from the mappings of multiple algorithms </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">sams</td><td>the sams to update </td></tr>
    <tr><td class="paramname">seq_len</td><td>the sequence length </td></tr>
    <tr><td class="paramname">opt</td><td>the program parameters </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>0 upon success, non-zero otherwise </dd></dl>

</div>
</div>
<a class="anchor" id="addaad04dd46c228c12e78650f3b17a19"></a><!-- doxytag: member="tmap_map_util.h::tmap_map_util_mapq_score" ref="addaad04dd46c228c12e78650f3b17a19" args="(int32_t seq_len, int32_t n_best, int32_t best_score, int32_t n_best_subo, int32_t best_subo_score, tmap_map_opt_t *opt)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int32_t tmap_map_util_mapq_score </td>
          <td>(</td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>seq_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>n_best</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>best_score</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>n_best_subo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>best_subo_score</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structtmap__map__opt__t.html">tmap_map_opt_t</a> *&#160;</td>
          <td class="paramname"><em>opt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Computes the mapping quality score from a small set of summary statistics. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">seq_len</td><td>the sequence length </td></tr>
    <tr><td class="paramname">n_best</td><td>the number of best scores </td></tr>
    <tr><td class="paramname">best_score</td><td>the best score </td></tr>
    <tr><td class="paramname">n_best_subo</td><td>the number of best suboptimal scores </td></tr>
    <tr><td class="paramname">best_subo_score</td><td>the best suboptimal score </td></tr>
    <tr><td class="paramname">opt</td><td>the program parameters </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>the mapping quality </dd></dl>

</div>
</div>
<a class="anchor" id="af60c1af840d0135043ca79a2979c8cdf"></a><!-- doxytag: member="tmap_map_util.h::tmap_map_util_remove_duplicates" ref="af60c1af840d0135043ca79a2979c8cdf" args="(tmap_map_sams_t *sams, int32_t dup_window, tmap_rand_t *rand)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void tmap_map_util_remove_duplicates </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structtmap__map__sams__t.html">tmap_map_sams_t</a> *&#160;</td>
          <td class="paramname"><em>sams</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>dup_window</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structtmap__rand__t.html">tmap_rand_t</a> *&#160;</td>
          <td class="paramname"><em>rand</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>removes duplicate alignments that fall within a given window </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">sams</td><td>the mappings to adjust </td></tr>
    <tr><td class="paramname">dup_window</td><td>the window size to cluster mappings </td></tr>
    <tr><td class="paramname">rand</td><td>the random number generator </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="aa138c1cd21a069836eb8c4d69603fc41"></a><!-- doxytag: member="tmap_map_util.h::tmap_map_util_sw_gen_cigar" ref="aa138c1cd21a069836eb8c4d69603fc41" args="(tmap_refseq_t *refseq, tmap_map_sams_t *sams, tmap_seq_t **seqs, tmap_map_opt_t *opt)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structtmap__map__sams__t.html">tmap_map_sams_t</a>* tmap_map_util_sw_gen_cigar </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structtmap__refseq__t.html">tmap_refseq_t</a> *&#160;</td>
          <td class="paramname"><em>refseq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structtmap__map__sams__t.html">tmap_map_sams_t</a> *&#160;</td>
          <td class="paramname"><em>sams</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structtmap__seq__t.html">tmap_seq_t</a> **&#160;</td>
          <td class="paramname"><em>seqs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structtmap__map__opt__t.html">tmap_map_opt_t</a> *&#160;</td>
          <td class="paramname"><em>opt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>perform local alignment</p>
<p>generates the cigar after tmap_map_util_sw_gen_score has been called </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">refseq</td><td>the reference sequence </td></tr>
    <tr><td class="paramname">sams</td><td>the seeded sams </td></tr>
    <tr><td class="paramname">seqs</td><td>the query sequence (forward, reverse compliment, reverse, and compliment) </td></tr>
    <tr><td class="paramname">opt</td><td>the program parameters </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>the locally aligned sams </dd></dl>

</div>
</div>
<a class="anchor" id="a66130a453a429b8c0139707aa73a94a3"></a><!-- doxytag: member="tmap_map_util.h::tmap_map_util_sw_gen_score" ref="a66130a453a429b8c0139707aa73a94a3" args="(tmap_refseq_t *refseq, tmap_map_sams_t *sams, tmap_seq_t **seqs, tmap_rand_t *rand, tmap_map_opt_t *opt)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structtmap__map__sams__t.html">tmap_map_sams_t</a>* tmap_map_util_sw_gen_score </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structtmap__refseq__t.html">tmap_refseq_t</a> *&#160;</td>
          <td class="paramname"><em>refseq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structtmap__map__sams__t.html">tmap_map_sams_t</a> *&#160;</td>
          <td class="paramname"><em>sams</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structtmap__seq__t.html">tmap_seq_t</a> **&#160;</td>
          <td class="paramname"><em>seqs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structtmap__rand__t.html">tmap_rand_t</a> *&#160;</td>
          <td class="paramname"><em>rand</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structtmap__map__opt__t.html">tmap_map_opt_t</a> *&#160;</td>
          <td class="paramname"><em>opt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>perform local alignment</p>
<p>only fills in the score, start and end of the alignments </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">refseq</td><td>the reference sequence </td></tr>
    <tr><td class="paramname">sams</td><td>the seeded sams </td></tr>
    <tr><td class="paramname">seqs</td><td>the query sequence (forward, reverse compliment, reverse, and compliment) </td></tr>
    <tr><td class="paramname">rand</td><td>the random number generator </td></tr>
    <tr><td class="paramname">opt</td><td>the program parameters </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>the locally aligned sams </dd></dl>

</div>
</div>
</div>


<hr class="footer"/><address class="footer"><small>
Generated on Wed Jun 13 2012 15:53:30 for TMAP by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.7.5.1
</small></address>

</body>
</html>
