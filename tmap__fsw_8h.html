<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>TMAP: /Users/nilshomer/git/tmap/src/sw/tmap_fsw.h File Reference</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />



</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">TMAP
   &#160;<span id="projectnumber">2.3.3</span>
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.5.1 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="dir_15187882eb12136f52a6e42c6006d23a.html">src</a>      </li>
      <li class="navelem"><a class="el" href="dir_23fff77d740776b7010fa4aa338611a4.html">sw</a>      </li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Defines</a> &#124;
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">tmap_fsw.h File Reference</div>  </div>
</div>
<div class="contents">

<p><a href="tmap__fsw_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structtmap__fsw__dpcell__t.html">tmap_fsw_dpcell_t</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structtmap__fsw__dpscore__t.html">tmap_fsw_dpscore_t</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structtmap__fsw__param__t.html">tmap_fsw_param_t</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structtmap__fsw__path__t.html">tmap_fsw_path_t</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structtmap__fsw__flowseq__t.html">tmap_fsw_flowseq_t</a></td></tr>
<tr><td colspan="2"><h2><a name="define-members"></a>
Defines</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tmap__fsw_8h.html#a025fdf2df4ac99ea741526062c10174d">TMAP_FSW_MAX_OFFSET</a>&#160;&#160;&#160;7</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tmap__fsw_8h.html#ab0cafb23f067f35b5382d37f887995e7">TMAP_FSW_SET_SCORE_INF</a>(s)&#160;&#160;&#160;(s).match_score = (s).ins_score = (s).del_score = TMAP_SW_MINOR_INF</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tmap__fsw_8h.html#abc72e833ad7b3887d76a8f098680b99f">TMAP_FSW_SET_FROM</a>(s, from)&#160;&#160;&#160;(s).match_from = (s).ins_from = (s).del_from = from</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tmap__fsw_8h.html#ab9c6188829b18996b0020bc97a920bd6">TMAP_FSW_SET_BC</a>(s, bc)&#160;&#160;&#160;(s).match_bc = (s).ins_bc = (s).del_bc = bc</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tmap__fsw_8h.html#a017d32058a7fa9d7eabf952cd1ba4ab1">TMAP_FSW_INIT_CELL</a>(s)&#160;&#160;&#160;(TMAP_FSW_SET_FROM(s,TMAP_FSW_FROM_S), TMAP_FSW_SET_BC(s, 0))</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tmap__fsw_8h.html#a71bccf5db76b522933ed10fc56ef4b63">TMAP_FSW_MAX_PATH_LENGTH</a>(ref_len, flow_len, offset)&#160;&#160;&#160;((1 + (ref_len * (flow_len + 1) * (offset + 1))))</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tmap__fsw_8h.html#a40dc9586a042892c53efb84ecc4af77f">__tmap_fsw_gen_ap1</a>(par, score_match, pen_mm, pen_gapo, pen_gape, fscore)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tmap__fsw_8h.html#a2e774746b9c74daff11f5510f76a69e6">__tmap_fsw_gen_ap</a>(par, opt)&#160;&#160;&#160;(__tmap_fsw_gen_ap1(par, (opt)-&gt;score_match, (opt)-&gt;pen_mm, (opt)-&gt;pen_gapo, (opt)-&gt;pen_gape), (opt)-&gt;fscore)</td></tr>
<tr><td colspan="2"><h2><a name="enum-members"></a>
Enumerations</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom">{ <br/>
&#160;&#160;<a class="el" href="tmap__fsw_8h.html#aba01db17f4a2bfbc3db60dc172972a25a40e071e9af2c820b9262b666d11c4d81">TMAP_FSW_FROM_M</a> =  0, 
<a class="el" href="tmap__fsw_8h.html#aba01db17f4a2bfbc3db60dc172972a25a7d3fcf0066faf9412eeeb581a8a73ccc">TMAP_FSW_FROM_I</a> =  1, 
<a class="el" href="tmap__fsw_8h.html#aba01db17f4a2bfbc3db60dc172972a25a51bdfde912e2a1a382af888fe4340ed5">TMAP_FSW_FROM_D</a> =  2, 
<a class="el" href="tmap__fsw_8h.html#aba01db17f4a2bfbc3db60dc172972a25ad03dcb12a0868225630626015d2b53f2">TMAP_FSW_FROM_S</a> =  3, 
<br/>
&#160;&#160;<a class="el" href="tmap__fsw_8h.html#aba01db17f4a2bfbc3db60dc172972a25af60df0cc1bd60f51123f9afafe94c5f3">TMAP_FSW_FROM_HP_PLUS</a> =  4, 
<a class="el" href="tmap__fsw_8h.html#aba01db17f4a2bfbc3db60dc172972a25a93a549e75585471f23ea2d582c822538">TMAP_FSW_FROM_HP_MINUS</a> =  5
<br/>
 }</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom">{ <a class="el" href="tmap__fsw_8h.html#aaf105ae5beaca1dee30ae54530691fcea98bf2c1f91e3e3d51446f05f6a13fa81">TMAP_FSW_NO_JUSTIFY</a> =  0, 
<a class="el" href="tmap__fsw_8h.html#aaf105ae5beaca1dee30ae54530691fceafebcbd9dfb55f16d773f0553697bb5e5">TMAP_FSW_JUSTIFY_LEFT_REF</a> =  1, 
<a class="el" href="tmap__fsw_8h.html#aaf105ae5beaca1dee30ae54530691fceab0b4ee2c99202ee4b66a0d15ef5647a6">TMAP_FSW_JUSTIFY_LEFT_READ</a> =  2
 }</td></tr>
<tr><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="structtmap__fsw__flowseq__t.html">tmap_fsw_flowseq_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tmap__fsw_8h.html#a7a7900dd41a1170b52d1177e86f1e1b9">tmap_fsw_flowseq_init</a> (uint8_t *flow_order, int32_t flow_order_len, uint8_t *base_calls, uint16_t *flowgram, int32_t num_flows, int32_t key_index, int32_t key_bases)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="structtmap__fsw__flowseq__t.html">tmap_fsw_flowseq_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tmap__fsw_8h.html#a35675cd7fd53424aa323f54ef6bc3f86">tmap_fsw_flowseq_from_seq</a> (<a class="el" href="structtmap__fsw__flowseq__t.html">tmap_fsw_flowseq_t</a> *fs, <a class="el" href="structtmap__seq__t.html">tmap_seq_t</a> *seq, uint8_t *flow_order, int32_t flow_order_len, uint8_t *key_seq, uint8_t key_seq_len, int32_t use_flowgram)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tmap__fsw_8h.html#a248e5259cee632b9ba6cebff13e2dc6b">tmap_fsw_flowseq_print</a> (<a class="el" href="structtmap__file__t.html">tmap_file_t</a> *fp, <a class="el" href="structtmap__fsw__flowseq__t.html">tmap_fsw_flowseq_t</a> *flowseq)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tmap__fsw_8h.html#ab7ec384c46cf5ba9c0feb32c1565c31c">tmap_fsw_flowseq_destroy_shallow</a> (<a class="el" href="structtmap__fsw__flowseq__t.html">tmap_fsw_flowseq_t</a> *flowseq)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tmap__fsw_8h.html#a5069df3737c81e787e1b863a987bd035">tmap_fsw_flowseq_destroy</a> (<a class="el" href="structtmap__fsw__flowseq__t.html">tmap_fsw_flowseq_t</a> *flowseq)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tmap__fsw_8h.html#a34c97435fb3f97a4bf9d94a0193f4304">tmap_fsw_sub_core</a> (uint8_t *seq, int32_t len, uint8_t flow_base, uint8_t base_call, uint16_t flow_signal, const <a class="el" href="structtmap__fsw__param__t.html">tmap_fsw_param_t</a> *ap, <a class="el" href="structtmap__fsw__dpcell__t.html">tmap_fsw_dpcell_t</a> **sub_dpcell, <a class="el" href="structtmap__fsw__dpscore__t.html">tmap_fsw_dpscore_t</a> **sub_score, <a class="el" href="structtmap__fsw__dpscore__t.html">tmap_fsw_dpscore_t</a> *score_last, <a class="el" href="structtmap__fsw__dpcell__t.html">tmap_fsw_dpcell_t</a> *dpcell_curr, <a class="el" href="structtmap__fsw__dpscore__t.html">tmap_fsw_dpscore_t</a> *score_curr, <a class="el" href="structtmap__fsw__path__t.html">tmap_fsw_path_t</a> *path, int32_t *path_len, int32_t best_ctype, uint8_t key_bases, int32_t flowseq_start_clip)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int64_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tmap__fsw_8h.html#a0a70f0299db8657503c4ef257ea225b7">tmap_fsw_extend_core</a> (uint8_t *seq, int32_t len, <a class="el" href="structtmap__fsw__flowseq__t.html">tmap_fsw_flowseq_t</a> *flowseq, const <a class="el" href="structtmap__fsw__param__t.html">tmap_fsw_param_t</a> *ap, int32_t right_j, <a class="el" href="structtmap__fsw__path__t.html">tmap_fsw_path_t</a> *path, int32_t *path_len, int32_t prev_score)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int64_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tmap__fsw_8h.html#a48d5e99acccc55e210a3213a35bda46d">tmap_fsw_extend_fitting_core</a> (uint8_t *seq, int32_t len, <a class="el" href="structtmap__fsw__flowseq__t.html">tmap_fsw_flowseq_t</a> *flowseq, const <a class="el" href="structtmap__fsw__param__t.html">tmap_fsw_param_t</a> *ap, int32_t right_j, <a class="el" href="structtmap__fsw__path__t.html">tmap_fsw_path_t</a> *path, int32_t *path_len, int32_t prev_score)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int64_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tmap__fsw_8h.html#a12c54199d54002ab978e8047cf55d3c0">tmap_fsw_clipping_core</a> (uint8_t *seq, int32_t len, <a class="el" href="structtmap__fsw__flowseq__t.html">tmap_fsw_flowseq_t</a> *flowseq, const <a class="el" href="structtmap__fsw__param__t.html">tmap_fsw_param_t</a> *ap, int32_t flowseq_start_clip, int32_t flowseq_end_clip, int32_t right_j, <a class="el" href="structtmap__fsw__path__t.html">tmap_fsw_path_t</a> *path, int32_t *path_len)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">uint32_t *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tmap__fsw_8h.html#ae3c32f5f89e0a764918c155a24960744">tmap_fsw_path2cigar</a> (const <a class="el" href="structtmap__fsw__path__t.html">tmap_fsw_path_t</a> *path, int32_t path_len, int32_t *n_cigar, int32_t rm_hp)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tmap__fsw_8h.html#ac681aeb8dd07e132d1ad5f32be6b3c33">tmap_fsw_get_aln</a> (<a class="el" href="structtmap__fsw__path__t.html">tmap_fsw_path_t</a> *path, int32_t path_len, uint8_t *flow_order, int32_t flow_order_len, uint8_t *target, uint8_t strand, char **ref, char **read, char **aln, int32_t j_type)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tmap__fsw_8h.html#a67d69429ff5b5e211a3ed80193851dc1">tmap_fsw_print_aln</a> (<a class="el" href="structtmap__file__t.html">tmap_file_t</a> *fp, int64_t score, <a class="el" href="structtmap__fsw__path__t.html">tmap_fsw_path_t</a> *path, int32_t path_len, uint8_t *flow_order, int32_t flow_order_len, uint8_t *target, uint8_t strand, int32_t j_type, char sep)</td></tr>
</table>
<hr/><h2>Define Documentation</h2>
<a class="anchor" id="a2e774746b9c74daff11f5510f76a69e6"></a><!-- doxytag: member="tmap_fsw.h::__tmap_fsw_gen_ap" ref="a2e774746b9c74daff11f5510f76a69e6" args="(par, opt)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define __tmap_fsw_gen_ap</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">par, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">opt&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;(__tmap_fsw_gen_ap1(par, (opt)-&gt;score_match, (opt)-&gt;pen_mm, (opt)-&gt;pen_gapo, (opt)-&gt;pen_gape), (opt)-&gt;fscore)</td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a40dc9586a042892c53efb84ecc4af77f"></a><!-- doxytag: member="tmap_fsw.h::__tmap_fsw_gen_ap1" ref="a40dc9586a042892c53efb84ecc4af77f" args="(par, score_match, pen_mm, pen_gapo, pen_gape, fscore)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define __tmap_fsw_gen_ap1</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">par, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">score_match, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">pen_mm, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">pen_gapo, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">pen_gape, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">fscore&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<b>Value:</b><div class="fragment"><pre class="fragment"><span class="keywordflow">do</span> { \
    int32_t i; \
    for(i=0;i&lt;25;i++) { \
        (par).matrix[i] = -100 * pen_mm; \
    } \
    for(i=0;i&lt;4;i++) { \
        (par).matrix[i*5+i] = 100 * score_match; \
    } \
    (par).gap_open = 100 * pen_gapo; \
    (par).gap_ext = 100 *pen_gape; \
    (par).gap_end = 100 * pen_gape; \
    (par).fscore = 100 * fscore; \
    (par).row = 5; \
} <span class="keywordflow">while</span>(0)
</pre></div>
</div>
</div>
<a class="anchor" id="a017d32058a7fa9d7eabf952cd1ba4ab1"></a><!-- doxytag: member="tmap_fsw.h::TMAP_FSW_INIT_CELL" ref="a017d32058a7fa9d7eabf952cd1ba4ab1" args="(s)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define TMAP_FSW_INIT_CELL</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">s</td><td>)</td>
          <td>&#160;&#160;&#160;(TMAP_FSW_SET_FROM(s,TMAP_FSW_FROM_S), TMAP_FSW_SET_BC(s, 0))</td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a025fdf2df4ac99ea741526062c10174d"></a><!-- doxytag: member="tmap_fsw.h::TMAP_FSW_MAX_OFFSET" ref="a025fdf2df4ac99ea741526062c10174d" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define TMAP_FSW_MAX_OFFSET&#160;&#160;&#160;7</td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a71bccf5db76b522933ed10fc56ef4b63"></a><!-- doxytag: member="tmap_fsw.h::TMAP_FSW_MAX_PATH_LENGTH" ref="a71bccf5db76b522933ed10fc56ef4b63" args="(ref_len, flow_len, offset)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define TMAP_FSW_MAX_PATH_LENGTH</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">ref_len, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">flow_len, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">offset&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;((1 + (ref_len * (flow_len + 1) * (offset + 1))))</td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="ab9c6188829b18996b0020bc97a920bd6"></a><!-- doxytag: member="tmap_fsw.h::TMAP_FSW_SET_BC" ref="ab9c6188829b18996b0020bc97a920bd6" args="(s, bc)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define TMAP_FSW_SET_BC</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">s, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">bc&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;(s).match_bc = (s).ins_bc = (s).del_bc = bc</td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="abc72e833ad7b3887d76a8f098680b99f"></a><!-- doxytag: member="tmap_fsw.h::TMAP_FSW_SET_FROM" ref="abc72e833ad7b3887d76a8f098680b99f" args="(s, from)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define TMAP_FSW_SET_FROM</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">s, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">from&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;(s).match_from = (s).ins_from = (s).del_from = from</td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="ab0cafb23f067f35b5382d37f887995e7"></a><!-- doxytag: member="tmap_fsw.h::TMAP_FSW_SET_SCORE_INF" ref="ab0cafb23f067f35b5382d37f887995e7" args="(s)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define TMAP_FSW_SET_SCORE_INF</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">s</td><td>)</td>
          <td>&#160;&#160;&#160;(s).match_score = (s).ins_score = (s).del_score = TMAP_SW_MINOR_INF</td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<hr/><h2>Enumeration Type Documentation</h2>
<a class="anchor" id="aba01db17f4a2bfbc3db60dc172972a25"></a><!-- doxytag: member="tmap_fsw.h::@15" ref="aba01db17f4a2bfbc3db60dc172972a25" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">anonymous enum</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>From which cell; helps recovert the best scoring path. </p>
<dl><dt><b>Enumerator: </b></dt><dd><table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em><a class="anchor" id="aba01db17f4a2bfbc3db60dc172972a25a40e071e9af2c820b9262b666d11c4d81"></a><!-- doxytag: member="TMAP_FSW_FROM_M" ref="aba01db17f4a2bfbc3db60dc172972a25a40e071e9af2c820b9262b666d11c4d81" args="" -->TMAP_FSW_FROM_M</em>&nbsp;</td><td>
<p>from a match/mismatch cell </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="aba01db17f4a2bfbc3db60dc172972a25a7d3fcf0066faf9412eeeb581a8a73ccc"></a><!-- doxytag: member="TMAP_FSW_FROM_I" ref="aba01db17f4a2bfbc3db60dc172972a25a7d3fcf0066faf9412eeeb581a8a73ccc" args="" -->TMAP_FSW_FROM_I</em>&nbsp;</td><td>
<p>from an insertion cell </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="aba01db17f4a2bfbc3db60dc172972a25a51bdfde912e2a1a382af888fe4340ed5"></a><!-- doxytag: member="TMAP_FSW_FROM_D" ref="aba01db17f4a2bfbc3db60dc172972a25a51bdfde912e2a1a382af888fe4340ed5" args="" -->TMAP_FSW_FROM_D</em>&nbsp;</td><td>
<p>from a deletion cell </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="aba01db17f4a2bfbc3db60dc172972a25ad03dcb12a0868225630626015d2b53f2"></a><!-- doxytag: member="TMAP_FSW_FROM_S" ref="aba01db17f4a2bfbc3db60dc172972a25ad03dcb12a0868225630626015d2b53f2" args="" -->TMAP_FSW_FROM_S</em>&nbsp;</td><td>
<p>from a start cell </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="aba01db17f4a2bfbc3db60dc172972a25af60df0cc1bd60f51123f9afafe94c5f3"></a><!-- doxytag: member="TMAP_FSW_FROM_HP_PLUS" ref="aba01db17f4a2bfbc3db60dc172972a25af60df0cc1bd60f51123f9afafe94c5f3" args="" -->TMAP_FSW_FROM_HP_PLUS</em>&nbsp;</td><td>
<p>from a match/mismatch cell, but a hp overcall error </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="aba01db17f4a2bfbc3db60dc172972a25a93a549e75585471f23ea2d582c822538"></a><!-- doxytag: member="TMAP_FSW_FROM_HP_MINUS" ref="aba01db17f4a2bfbc3db60dc172972a25a93a549e75585471f23ea2d582c822538" args="" -->TMAP_FSW_FROM_HP_MINUS</em>&nbsp;</td><td>
<p>from a match/mismatch cell, but a hp undercall error </p>
</td></tr>
</table>
</dd>
</dl>

</div>
</div>
<a class="anchor" id="aaf105ae5beaca1dee30ae54530691fce"></a><!-- doxytag: member="tmap_fsw.h::@16" ref="aaf105ae5beaca1dee30ae54530691fce" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">anonymous enum</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<dl><dt><b>Enumerator: </b></dt><dd><table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em><a class="anchor" id="aaf105ae5beaca1dee30ae54530691fcea98bf2c1f91e3e3d51446f05f6a13fa81"></a><!-- doxytag: member="TMAP_FSW_NO_JUSTIFY" ref="aaf105ae5beaca1dee30ae54530691fcea98bf2c1f91e3e3d51446f05f6a13fa81" args="" -->TMAP_FSW_NO_JUSTIFY</em>&nbsp;</td><td>
<p>do not perform indel justification </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="aaf105ae5beaca1dee30ae54530691fceafebcbd9dfb55f16d773f0553697bb5e5"></a><!-- doxytag: member="TMAP_FSW_JUSTIFY_LEFT_REF" ref="aaf105ae5beaca1dee30ae54530691fceafebcbd9dfb55f16d773f0553697bb5e5" args="" -->TMAP_FSW_JUSTIFY_LEFT_REF</em>&nbsp;</td><td>
<p>justify 5' on the reference strand </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="aaf105ae5beaca1dee30ae54530691fceab0b4ee2c99202ee4b66a0d15ef5647a6"></a><!-- doxytag: member="TMAP_FSW_JUSTIFY_LEFT_READ" ref="aaf105ae5beaca1dee30ae54530691fceab0b4ee2c99202ee4b66a0d15ef5647a6" args="" -->TMAP_FSW_JUSTIFY_LEFT_READ</em>&nbsp;</td><td>
<p>justify 5' on the read strand </p>
</td></tr>
</table>
</dd>
</dl>

</div>
</div>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="a12c54199d54002ab978e8047cf55d3c0"></a><!-- doxytag: member="tmap_fsw.h::tmap_fsw_clipping_core" ref="a12c54199d54002ab978e8047cf55d3c0" args="(uint8_t *seq, int32_t len, tmap_fsw_flowseq_t *flowseq, const tmap_fsw_param_t *ap, int32_t flowseq_start_clip, int32_t flowseq_end_clip, int32_t right_j, tmap_fsw_path_t *path, int32_t *path_len)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int64_t tmap_fsw_clipping_core </td>
          <td>(</td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>seq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structtmap__fsw__flowseq__t.html">tmap_fsw_flowseq_t</a> *&#160;</td>
          <td class="paramname"><em>flowseq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structtmap__fsw__param__t.html">tmap_fsw_param_t</a> *&#160;</td>
          <td class="paramname"><em>ap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>flowseq_start_clip</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>flowseq_end_clip</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>right_j</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structtmap__fsw__path__t.html">tmap_fsw_path_t</a> *&#160;</td>
          <td class="paramname"><em>path</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t *&#160;</td>
          <td class="paramname"><em>path_len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Performs flow-space Smith-Waterman alignment </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">seq</td><td>the 2-bit DNA reference sequence </td></tr>
    <tr><td class="paramname">len</td><td>the length of the second sequence </td></tr>
    <tr><td class="paramname">flowseq</td><td>the flow sequence structure to align </td></tr>
    <tr><td class="paramname">ap</td><td>the alignment parameters </td></tr>
    <tr><td class="paramname">path</td><td>the returned alignment path with maximum length of (1 + [len * (num_flows + 1) * (ap-&gt;offset + 1)]) </td></tr>
    <tr><td class="paramname">path_len</td><td>the returned path_len </td></tr>
    <tr><td class="paramname">flowseq_start_clip</td><td>1 to allow clipping at the start of the flow sequence, 0 otherwise </td></tr>
    <tr><td class="paramname">flowseq_end_clip</td><td>1 to allow clipping at the end of the flow sequence, 0 otherwise </td></tr>
    <tr><td class="paramname">right_j</td><td>1 to justify indels to the right, 0 otherwise </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>the returned alignment score</dd></dl>
<p>this assumes that the ap parameter scores have been multiplied by 100; only include non-key flows </p>

</div>
</div>
<a class="anchor" id="a0a70f0299db8657503c4ef257ea225b7"></a><!-- doxytag: member="tmap_fsw.h::tmap_fsw_extend_core" ref="a0a70f0299db8657503c4ef257ea225b7" args="(uint8_t *seq, int32_t len, tmap_fsw_flowseq_t *flowseq, const tmap_fsw_param_t *ap, int32_t right_j, tmap_fsw_path_t *path, int32_t *path_len, int32_t prev_score)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int64_t tmap_fsw_extend_core </td>
          <td>(</td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>seq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structtmap__fsw__flowseq__t.html">tmap_fsw_flowseq_t</a> *&#160;</td>
          <td class="paramname"><em>flowseq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structtmap__fsw__param__t.html">tmap_fsw_param_t</a> *&#160;</td>
          <td class="paramname"><em>ap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>right_j</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structtmap__fsw__path__t.html">tmap_fsw_path_t</a> *&#160;</td>
          <td class="paramname"><em>path</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t *&#160;</td>
          <td class="paramname"><em>path_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>prev_score</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Performs flow-space Smith-Waterman alignment extension </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">seq</td><td>the 2-bit DNA reference sequence </td></tr>
    <tr><td class="paramname">len</td><td>the length of the second sequence </td></tr>
    <tr><td class="paramname">flowseq</td><td>the flow sequence structure to align </td></tr>
    <tr><td class="paramname">ap</td><td>the alignment parameters </td></tr>
    <tr><td class="paramname">right_j</td><td>1 to justify indels to the right, 0 otherwise </td></tr>
    <tr><td class="paramname">path</td><td>the returned alignment path with maximum length of (1 + [len * (num_flows + 1) * (ap-&gt;offset + 1)]) </td></tr>
    <tr><td class="paramname">path_len</td><td>the returned path_len </td></tr>
    <tr><td class="paramname">prev_score</td><td>the alignment score up to this point </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>the returned alignment score</dd></dl>
<p>this assumes that the ap parameter scores have been multiplied by 100; only include non-key flows </p>

</div>
</div>
<a class="anchor" id="a48d5e99acccc55e210a3213a35bda46d"></a><!-- doxytag: member="tmap_fsw.h::tmap_fsw_extend_fitting_core" ref="a48d5e99acccc55e210a3213a35bda46d" args="(uint8_t *seq, int32_t len, tmap_fsw_flowseq_t *flowseq, const tmap_fsw_param_t *ap, int32_t right_j, tmap_fsw_path_t *path, int32_t *path_len, int32_t prev_score)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int64_t tmap_fsw_extend_fitting_core </td>
          <td>(</td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>seq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structtmap__fsw__flowseq__t.html">tmap_fsw_flowseq_t</a> *&#160;</td>
          <td class="paramname"><em>flowseq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structtmap__fsw__param__t.html">tmap_fsw_param_t</a> *&#160;</td>
          <td class="paramname"><em>ap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>right_j</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structtmap__fsw__path__t.html">tmap_fsw_path_t</a> *&#160;</td>
          <td class="paramname"><em>path</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t *&#160;</td>
          <td class="paramname"><em>path_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>prev_score</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Performs flow-space Smith-Waterman alignment extension and aligns the entire flowgram </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">seq</td><td>the 2-bit DNA reference sequence </td></tr>
    <tr><td class="paramname">len</td><td>the length of the second sequence </td></tr>
    <tr><td class="paramname">flowseq</td><td>the flow sequence structure to align </td></tr>
    <tr><td class="paramname">ap</td><td>the alignment parameters </td></tr>
    <tr><td class="paramname">right_j</td><td>1 to justify indels to the right, 0 otherwise </td></tr>
    <tr><td class="paramname">path</td><td>the returned alignment path with maximum length of (1 + [len * (num_flows + 1) * (ap-&gt;offset + 1)]) </td></tr>
    <tr><td class="paramname">path_len</td><td>the returned path_len </td></tr>
    <tr><td class="paramname">prev_score</td><td>the alignment score up to this point </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>the returned alignment score</dd></dl>
<p>this assumes that the ap parameter scores have been multiplied by 100; only include non-key flows </p>

</div>
</div>
<a class="anchor" id="a5069df3737c81e787e1b863a987bd035"></a><!-- doxytag: member="tmap_fsw.h::tmap_fsw_flowseq_destroy" ref="a5069df3737c81e787e1b863a987bd035" args="(tmap_fsw_flowseq_t *flowseq)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void tmap_fsw_flowseq_destroy </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structtmap__fsw__flowseq__t.html">tmap_fsw_flowseq_t</a> *&#160;</td>
          <td class="paramname"><em>flowseq</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">flowseq</td><td>pointer to the flow sequence to destroy</td></tr>
  </table>
  </dd>
</dl>
<p>Frees the memory associated with this structure </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">flowseq</td><td>pointer the flow sequence to free </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ab7ec384c46cf5ba9c0feb32c1565c31c"></a><!-- doxytag: member="tmap_fsw.h::tmap_fsw_flowseq_destroy_shallow" ref="ab7ec384c46cf5ba9c0feb32c1565c31c" args="(tmap_fsw_flowseq_t *flowseq)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void tmap_fsw_flowseq_destroy_shallow </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structtmap__fsw__flowseq__t.html">tmap_fsw_flowseq_t</a> *&#160;</td>
          <td class="paramname"><em>flowseq</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">flowseq</td><td>pointer to the flow sequence to destroy</td></tr>
  </table>
  </dd>
</dl>
<p>this does a shallow-destroy </p>

</div>
</div>
<a class="anchor" id="a35675cd7fd53424aa323f54ef6bc3f86"></a><!-- doxytag: member="tmap_fsw.h::tmap_fsw_flowseq_from_seq" ref="a35675cd7fd53424aa323f54ef6bc3f86" args="(tmap_fsw_flowseq_t *fs, tmap_seq_t *seq, uint8_t *flow_order, int32_t flow_order_len, uint8_t *key_seq, uint8_t key_seq_len, int32_t use_flowgram)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structtmap__fsw__flowseq__t.html">tmap_fsw_flowseq_t</a>* tmap_fsw_flowseq_from_seq </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structtmap__fsw__flowseq__t.html">tmap_fsw_flowseq_t</a> *&#160;</td>
          <td class="paramname"><em>fs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structtmap__seq__t.html">tmap_seq_t</a> *&#160;</td>
          <td class="paramname"><em>seq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>flow_order</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>flow_order_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>key_seq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>key_seq_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>use_flowgram</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Create a structure for flow-space Smith Waterman from an sequence structure </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">fs</td><td>a flow space structure to re-use, null otherwise </td></tr>
    <tr><td class="paramname">seq</td><td>the sequence structure </td></tr>
    <tr><td class="paramname">flow_order</td><td>the flow order (in integer format) </td></tr>
    <tr><td class="paramname">flow_order_len</td><td>the flow order length </td></tr>
    <tr><td class="paramname">key_seq</td><td>the key sequence (in integer format) </td></tr>
    <tr><td class="paramname">key_seq_len</td><td>the key sequence length </td></tr>
    <tr><td class="paramname">use_flowgram</td><td>use the flowgram if available </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>pointer to the flowseq structure </dd></dl>

</div>
</div>
<a class="anchor" id="a7a7900dd41a1170b52d1177e86f1e1b9"></a><!-- doxytag: member="tmap_fsw.h::tmap_fsw_flowseq_init" ref="a7a7900dd41a1170b52d1177e86f1e1b9" args="(uint8_t *flow_order, int32_t flow_order_len, uint8_t *base_calls, uint16_t *flowgram, int32_t num_flows, int32_t key_index, int32_t key_bases)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structtmap__fsw__flowseq__t.html">tmap_fsw_flowseq_t</a>* tmap_fsw_flowseq_init </td>
          <td>(</td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>flow_order</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>flow_order_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>base_calls</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t *&#160;</td>
          <td class="paramname"><em>flowgram</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>num_flows</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>key_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>key_bases</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Stores parameters for flow-space Smith-Waterman </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">flow_order</td><td>for each of the four flows, the 2-bit DNA base flowed </td></tr>
    <tr><td class="paramname">flow_order_len</td><td>the flow order length </td></tr>
    <tr><td class="paramname">base_calls</td><td>for each flow, the number of bases called [0-255] </td></tr>
    <tr><td class="paramname">flowgram</td><td>for each flow, the flowgram signal (100*signal) </td></tr>
    <tr><td class="paramname">num_flows</td><td>the number of flows </td></tr>
    <tr><td class="paramname">key_index</td><td>the 0-based index of the key base if the key is part of the first or last flow (should be -1, 0, or num_flow-1). </td></tr>
    <tr><td class="paramname">key_bases</td><td>the number of bases part of the key_index flow that are explained by the key sequence </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>pointer to the initialized memory </dd></dl>

</div>
</div>
<a class="anchor" id="a248e5259cee632b9ba6cebff13e2dc6b"></a><!-- doxytag: member="tmap_fsw.h::tmap_fsw_flowseq_print" ref="a248e5259cee632b9ba6cebff13e2dc6b" args="(tmap_file_t *fp, tmap_fsw_flowseq_t *flowseq)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void tmap_fsw_flowseq_print </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structtmap__file__t.html">tmap_file_t</a> *&#160;</td>
          <td class="paramname"><em>fp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structtmap__fsw__flowseq__t.html">tmap_fsw_flowseq_t</a> *&#160;</td>
          <td class="paramname"><em>flowseq</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">fp</td><td>the file stream in which to print </td></tr>
    <tr><td class="paramname">flowseq</td><td>the flow sequence to print </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ac681aeb8dd07e132d1ad5f32be6b3c33"></a><!-- doxytag: member="tmap_fsw.h::tmap_fsw_get_aln" ref="ac681aeb8dd07e132d1ad5f32be6b3c33" args="(tmap_fsw_path_t *path, int32_t path_len, uint8_t *flow_order, int32_t flow_order_len, uint8_t *target, uint8_t strand, char **ref, char **read, char **aln, int32_t j_type)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void tmap_fsw_get_aln </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structtmap__fsw__path__t.html">tmap_fsw_path_t</a> *&#160;</td>
          <td class="paramname"><em>path</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>path_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>flow_order</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>flow_order_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>target</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>strand</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **&#160;</td>
          <td class="paramname"><em>ref</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **&#160;</td>
          <td class="paramname"><em>read</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **&#160;</td>
          <td class="paramname"><em>aln</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>j_type</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Gets the pretty-print alignment </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">path</td><td>the alignment path </td></tr>
    <tr><td class="paramname">path_len</td><td>the alignment path length </td></tr>
    <tr><td class="paramname">flow_order</td><td>the flow order </td></tr>
    <tr><td class="paramname">flow_order_len</td><td>the flow order length </td></tr>
    <tr><td class="paramname">target</td><td>the 2-bit DNA reference sequence </td></tr>
    <tr><td class="paramname">strand</td><td>0 for the forward strand, 1 for the reverse </td></tr>
    <tr><td class="paramname">ref</td><td>pointer to the returned reference string </td></tr>
    <tr><td class="paramname">read</td><td>pointer to the returned read string </td></tr>
    <tr><td class="paramname">aln</td><td>pointer to the returned alignment string </td></tr>
    <tr><td class="paramname">j_type</td><td>the indel justification method </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ae3c32f5f89e0a764918c155a24960744"></a><!-- doxytag: member="tmap_fsw.h::tmap_fsw_path2cigar" ref="ae3c32f5f89e0a764918c155a24960744" args="(const tmap_fsw_path_t *path, int32_t path_len, int32_t *n_cigar, int32_t rm_hp)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t* tmap_fsw_path2cigar </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structtmap__fsw__path__t.html">tmap_fsw_path_t</a> *&#160;</td>
          <td class="paramname"><em>path</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>path_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t *&#160;</td>
          <td class="paramname"><em>n_cigar</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>rm_hp</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Creates a cigar array from an alignment path </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">path</td><td>the Smith-Waterman alignment path </td></tr>
    <tr><td class="paramname">path_len</td><td>the Smith-Waterman alignment path length </td></tr>
    <tr><td class="paramname">n_cigar</td><td>pointer to the returned number of cigar operations </td></tr>
    <tr><td class="paramname">rm_hp</td><td>1 if we are to remove hp edits (merge into indels), 0 otherwise </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>the cigar array, NULL if the path is NULL or the path length is zero </dd></dl>

</div>
</div>
<a class="anchor" id="a67d69429ff5b5e211a3ed80193851dc1"></a><!-- doxytag: member="tmap_fsw.h::tmap_fsw_print_aln" ref="a67d69429ff5b5e211a3ed80193851dc1" args="(tmap_file_t *fp, int64_t score, tmap_fsw_path_t *path, int32_t path_len, uint8_t *flow_order, int32_t flow_order_len, uint8_t *target, uint8_t strand, int32_t j_type, char sep)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void tmap_fsw_print_aln </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structtmap__file__t.html">tmap_file_t</a> *&#160;</td>
          <td class="paramname"><em>fp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int64_t&#160;</td>
          <td class="paramname"><em>score</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structtmap__fsw__path__t.html">tmap_fsw_path_t</a> *&#160;</td>
          <td class="paramname"><em>path</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>path_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>flow_order</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>flow_order_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>target</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>strand</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>j_type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char&#160;</td>
          <td class="paramname"><em>sep</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Pretty-prints an alignment </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">fp</td><td>the file pointer to print </td></tr>
    <tr><td class="paramname">score</td><td>the flow space alignment score </td></tr>
    <tr><td class="paramname">path</td><td>the alignment path </td></tr>
    <tr><td class="paramname">path_len</td><td>the alignment path length </td></tr>
    <tr><td class="paramname">flow_order</td><td>the flow order </td></tr>
    <tr><td class="paramname">flow_order_len</td><td>the flow order length </td></tr>
    <tr><td class="paramname">target</td><td>the 2-bit DNA reference sequence </td></tr>
    <tr><td class="paramname">strand</td><td>0 for the forward strand, 1 for the reverse </td></tr>
    <tr><td class="paramname">j_type</td><td>the indel justification method </td></tr>
    <tr><td class="paramname">sep</td><td>the field separator </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a34c97435fb3f97a4bf9d94a0193f4304"></a><!-- doxytag: member="tmap_fsw.h::tmap_fsw_sub_core" ref="a34c97435fb3f97a4bf9d94a0193f4304" args="(uint8_t *seq, int32_t len, uint8_t flow_base, uint8_t base_call, uint16_t flow_signal, const tmap_fsw_param_t *ap, tmap_fsw_dpcell_t **sub_dpcell, tmap_fsw_dpscore_t **sub_score, tmap_fsw_dpscore_t *score_last, tmap_fsw_dpcell_t *dpcell_curr, tmap_fsw_dpscore_t *score_curr, tmap_fsw_path_t *path, int32_t *path_len, int32_t best_ctype, uint8_t key_bases, int32_t flowseq_start_clip)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void tmap_fsw_sub_core </td>
          <td>(</td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>seq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>flow_base</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>base_call</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>flow_signal</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structtmap__fsw__param__t.html">tmap_fsw_param_t</a> *&#160;</td>
          <td class="paramname"><em>ap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structtmap__fsw__dpcell__t.html">tmap_fsw_dpcell_t</a> **&#160;</td>
          <td class="paramname"><em>sub_dpcell</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structtmap__fsw__dpscore__t.html">tmap_fsw_dpscore_t</a> **&#160;</td>
          <td class="paramname"><em>sub_score</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structtmap__fsw__dpscore__t.html">tmap_fsw_dpscore_t</a> *&#160;</td>
          <td class="paramname"><em>score_last</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structtmap__fsw__dpcell__t.html">tmap_fsw_dpcell_t</a> *&#160;</td>
          <td class="paramname"><em>dpcell_curr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structtmap__fsw__dpscore__t.html">tmap_fsw_dpscore_t</a> *&#160;</td>
          <td class="paramname"><em>score_curr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structtmap__fsw__path__t.html">tmap_fsw_path_t</a> *&#160;</td>
          <td class="paramname"><em>path</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t *&#160;</td>
          <td class="paramname"><em>path_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>best_ctype</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>key_bases</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>flowseq_start_clip</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Fills in a row for one flow-space Smith-Waterman alignment </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">seq</td><td>the 2-bit DNA reference sequence </td></tr>
    <tr><td class="paramname">len</td><td>the length of the second sequence </td></tr>
    <tr><td class="paramname">flow_base</td><td>the base associated with this flow </td></tr>
    <tr><td class="paramname">base_call</td><td>the number of bases called (do not inclue the key base(s)) </td></tr>
    <tr><td class="paramname">flow_signal</td><td>the flow signal of this flow (100*signal) </td></tr>
    <tr><td class="paramname">ap</td><td>the alignment parameters </td></tr>
    <tr><td class="paramname">sub_dpcell</td><td>pre-allocated DP cells of minimum dimensions [base_call+2*(ap-&gt;offset+1),len+1] </td></tr>
    <tr><td class="paramname">sub_score</td><td>pre-allocated DP scores of minimum dimensions [base_call+2*(ap-&gt;offset+1),len+1] </td></tr>
    <tr><td class="paramname">score_last</td><td>the last score row in the DP matrix </td></tr>
    <tr><td class="paramname">dpcell_curr</td><td>the current cell row in the DP matrix </td></tr>
    <tr><td class="paramname">score_curr</td><td>the current score row in the DP matrix </td></tr>
    <tr><td class="paramname">path</td><td>the sub-alignment path, NULL if not required </td></tr>
    <tr><td class="paramname">path_len</td><td>the returned sub-alignment path length, 0 if path is NULL </td></tr>
    <tr><td class="paramname">best_ctype</td><td>the sub-cell from which to backtrace if path is not NULL </td></tr>
    <tr><td class="paramname">key_bases</td><td>the number of key bases that are part of this flow </td></tr>
    <tr><td class="paramname">flowseq_start_clip</td><td>1 to allow clipping at the start of the flow sequence, 0 otherwise</td></tr>
  </table>
  </dd>
</dl>
<p>this assumes that the ap parameter scores have been multiplied by 100; only include non-key flows </p>

</div>
</div>
</div>


<hr class="footer"/><address class="footer"><small>
Generated on Wed Jun 13 2012 15:53:30 for TMAP by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.7.5.1
</small></address>

</body>
</html>
